<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
    
<!-- Thu ngân bãi giao ca -->    
    	<record id="view_thungan_bai_giaoca_tree" model="ir.ui.view">
            <field name="name">thungan.bai.giaoca.tree</field>
            <field name="model">thungan.bai.giaoca</field>
            <field name="arch" type="xml">
                <tree string="Thu ngân bãi giao ca" editable='top'>
                    <field name="name"/>
                </tree>
            </field>
        </record>
        <record id="action_thungan_bai_giaoca" model="ir.actions.act_window">
            <field name="name">Thu ngân bãi giao ca</field>
            <field name="res_model">thungan.bai.giaoca</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_thungan_bai_giaoca_tree"/>
        </record>
        
<!-- Điều hành bãi giao ca -->    
    	<record id="view_dieuhanh_bai_giaoca_tree" model="ir.ui.view">
            <field name="name">dieuhanh.bai.giaoca.tree</field>
            <field name="model">dieuhanh.bai.giaoca</field>
            <field name="arch" type="xml">
                <tree string="Điều hành bãi giao ca" editable='top'>
                    <field name="name"/>
                </tree>
            </field>
        </record>
        <record id="action_dieuhanh_bai_giaoca" model="ir.actions.act_window">
            <field name="name">Điều hành bãi giao ca</field>
            <field name="res_model">dieuhanh.bai.giaoca</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_dieuhanh_bai_giaoca_tree"/>
        </record>
        
<!-- Bãi giao ca -->    
    	<record id="view_bai_giaoca_tree" model="ir.ui.view">
            <field name="name">bai.giaoca.tree</field>
            <field name="model">bai.giaoca</field>
            <field name="arch" type="xml">
                <tree string="Bãi giao ca" editable='top'>
                    <field name="code"/>
                    <field name="name"/>
                    <field name="thungan_id"/>
                    <field name="dieuhanh_id"/>
                    <field name="account_id" domain="[('type','=','other')]"/>
                </tree>
            </field>
        </record>
        <record id="action_bai_giaoca" model="ir.actions.act_window">
            <field name="name">Bãi giao ca</field>
            <field name="res_model">bai.giaoca</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_bai_giaoca_tree"/>
        </record>
        
<!-- Loại đối tượng -->    
    	<record id="view_loai_doi_tuong_tree" model="ir.ui.view">
            <field name="name">loai.doi.tuong.tree</field>
            <field name="model">loai.doi.tuong</field>
            <field name="arch" type="xml">
                <tree string="Loại đối tượng" editable='top'>
                    <field name="name"/>
                </tree>
            </field>
        </record>
        <record id="action_loai_doi_tuong" model="ir.actions.act_window">
            <field name="name">Loại đối tượng</field>
            <field name="res_model">loai.doi.tuong</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_loai_doi_tuong_tree"/>
        </record>
        
<!-- Loại ký quỹ -->    
    	<record id="view_loai_ky_quy_tree" model="ir.ui.view">
            <field name="name">loai.ky.quy.tree</field>
            <field name="model">loai.ky.quy</field>
            <field name="arch" type="xml">
                <tree string="Loại ký quỹ" editable='top'>
                    <field name="name"/>
                    <field name="description"/>
                </tree>
            </field>
        </record>
        <record id="action_loai_ky_quy" model="ir.actions.act_window">
            <field name="name">Loại ký quỹ</field>
            <field name="res_model">loai.ky.quy</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_loai_ky_quy_tree"/>
        </record>
        
<!-- Loại tạm ứng -->    
    	<record id="view_loai_tam_ung_tree" model="ir.ui.view">
            <field name="name">loai.tam.ung.tree</field>
            <field name="model">loai.tam.ung</field>
            <field name="arch" type="xml">
                <tree string="Loại tạm ứng" editable='top'>
                    <field name="name"/>
                </tree>
            </field>
        </record>
        <record id="action_loai_tam_ung" model="ir.actions.act_window">
            <field name="name">Loại tạm ứng</field>
            <field name="res_model">loai.tam.ung</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_loai_tam_ung_tree"/>
        </record>

<!-- Loại vi phạm -->    
    	<record id="view_loai_vi_pham_tree" model="ir.ui.view">
            <field name="name">loai.vi.pham.tree</field>
            <field name="model">loai.vi.pham</field>
            <field name="arch" type="xml">
                <tree string="Loại vi phạm" editable='top'>
                    <field name="name"/>
                    <field name="description"/>
                </tree>
            </field>
        </record>
        <record id="action_loai_vi_pham" model="ir.actions.act_window">
            <field name="name">Loại vi phạm</field>
            <field name="res_model">loai.vi.pham</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_loai_vi_pham_tree"/>
        </record>

<!-- Thêm bãi giao ca -->
		<record id="view_account_move_line_filter_inherit" model="ir.ui.view">
            <field name="name">account.move.line.filter.inherit</field>
            <field name="model">account.move.line</field>
            <field name="priority">2</field>
            <field name="inherit_id" ref="account.view_account_move_line_filter"/>
            <field name="arch" type="xml">
                <filter string="Account" position="replace">
                </filter>
                <filter string="Partner" position="replace">
                	<filter name="doi_xe" string="Đội xe" icon="terp-folder-green" context="{'group_by':'account_id'}"/>
                	<filter name="thuchi" string="Thu/Chi" icon="terp-go-month" domain="[]" context="{'group_by':'thu_chi'}"/>
                	<filter name="loaicongno" string="Loại công nợ" icon="terp-go-month" domain="[]" context="{'group_by':'mlg_type'}"/>
                	<filter name="bai_giao_ca" string="Bãi giao ca" icon="terp-go-month" domain="[]" context="{'group_by':'bai_giaoca_id'}"/>
                	<filter name="doi_tuong" string="Partner" icon="terp-partner" domain="[]" context="{'group_by':'partner_id'}"/>
                </filter>
                <field name="partner_id" position="after">
                	<field name="thu_chi"/>
                	<field name="mlg_type"/>
                	<field name="bai_giaoca_id"/>
                </field>
            </field>
        </record>
        <record id="view_move_line_tree_inherit" model="ir.ui.view">
            <field name="name">account.move.line.tree.inherit</field>
            <field name="model">account.move.line</field>
            <field name="priority">2</field>
            <field name="inherit_id" ref="account.view_move_line_tree"/>
            <field name="arch" type="xml">
                <field name="account_id" position="after">
                	<field name="thu_chi" invisible='1'/>
                	<field name="mlg_type" invisible='1'/>
                	<field name="bai_giaoca_id" invisible='1'/>
                </field>
                <xpath expr="//field[@name='name']" position="attributes">
	        		<attribute name="invisible">1</attribute>
	        	</xpath>
	        	<xpath expr="//field[@name='move_id']" position="attributes">
	        		<attribute name="invisible">1</attribute>
	        	</xpath>
	        	<xpath expr="//field[@name='partner_id']" position="attributes">
	        		<attribute name="invisible">1</attribute>
	        	</xpath>
	        	<xpath expr="//field[@name='account_id']" position="attributes">
	        		<attribute name="invisible">1</attribute>
	        	</xpath>
	        	<xpath expr="//field[@name='reconcile_ref']" position="attributes">
	        		<attribute name="invisible">1</attribute>
	        	</xpath>
	        	<xpath expr="//field[@name='credit']" position="after">
	        		<field name="con_lai"/>
	        	</xpath>
            </field>
        </record>
        <record id="view_vendor_receipt_dialog_form_inherit" model="ir.ui.view">
            <field name="name">account.voucher.form.inherit</field>
            <field name="model">account.voucher</field>
            <field name="priority">2</field>
            <field name="inherit_id" ref="account_voucher.view_vendor_receipt_dialog_form"/>
            <field name="arch" type="xml">
            	<xpath expr="//field[@name='type']" position="after">
	        		<field name="bai_giaoca_id" invisible="1"/>
	        		<field name="mlg_type" invisible="1"/>
	        	</xpath>
	        	<xpath expr="//field[@name='line_cr_ids']/tree/field[@name='account_id']" position="after">
	        		<field name="mlg_type"/>
	        		<field name="bai_giaoca_id" readonly="0"/>
	        	</xpath>
	        	<xpath expr="//field[@name='line_dr_ids']/tree/field[@name='account_id']" position="after">
	        		<field name="mlg_type"/>
	        		<field name="bai_giaoca_id" readonly="0"/>
	        	</xpath>
            </field>
        </record>
        <record id="view_vendor_receipt_form_inherit" model="ir.ui.view">
            <field name="name">account.voucher.form.inherit</field>
            <field name="model">account.voucher</field>
            <field name="priority">2</field>
            <field name="inherit_id" ref="account_voucher.view_vendor_receipt_form"/>
            <field name="arch" type="xml">
            	<xpath expr="//field[@name='type']" position="after">
	        		<field name="bai_giaoca_id" invisible="1"/>
	        		<field name="mlg_type" invisible="1"/>
	        	</xpath>
	        	<xpath expr="//field[@name='line_cr_ids']/tree/field[@name='account_id']" position="after">
	        		<field name="mlg_type"/>
	        		<field name="bai_giaoca_id" readonly="0"/>
	        	</xpath>
	        	<xpath expr="//field[@name='line_dr_ids']/tree/field[@name='account_id']" position="after">
	        		<field name="mlg_type"/>
	        		<field name="bai_giaoca_id" readonly="0"/>
	        	</xpath>
            </field>
        </record>

<!-- Thêm chi nhánh trên journal -->
		<record id="view_account_journal_form_inherit" model="ir.ui.view">
            <field name="name">account.journal.form.inherit</field>
            <field name="model">account.journal</field>
            <field name="priority">2</field>
            <field name="inherit_id" ref="account.view_account_journal_form"/>
            <field name="arch" type="xml">
	        	<xpath expr="//field[@name='type']" position="after">
	        		<field name="chinhanh_id" domain="[('parent_id.code','=','1')]"/>
	        	</xpath>
            </field>
        </record>

<!-- Thêm chi nhánh trên voucher thanh toan invoice -->
		<record id="view_vendor_receipt_dialog_form_inherit" model="ir.ui.view">
            <field name="name">account.voucher.form.inherit</field>
            <field name="model">account.voucher</field>
            <field name="priority">2</field>
            <field name="inherit_id" ref="account_voucher.view_vendor_receipt_dialog_form"/>
            <field name="arch" type="xml">
	        	<xpath expr="//field[@name='amount']" position="after">
	        		<field name="chinhanh_id" invisible='1' domain="[('parent_id.code','=','1')]"/>
	        	</xpath>
	        	<xpath expr="//field[@name='journal_id']" position="attributes">
	        		<attribute name="domain">[('chinhanh_id','=',chinhanh_id)]</attribute>
	        	</xpath>
            </field>
        </record>
        
<!-- Chỉnh sửa coa k thấy account trung gian -->
        <record id="account.action_account_tree" model="ir.actions.act_window">
            <field name="name">Chart of Accounts</field>
            <field name="res_model">account.account</field>
            <field name="view_type">tree</field>
            <field name="view_id" ref="account.view_account_tree"/>
            <field name="domain">[('parent_id','=',False),('code','not in',['1111','1112'])]</field>
        </record>

<!-- Biển số xe -->    
    	<record id="view_bien_so_xe_tree" model="ir.ui.view">
            <field name="name">bien.so.xe.tree</field>
            <field name="model">bien.so.xe</field>
            <field name="arch" type="xml">
                <tree string="Biển số xe" editable='top'>
                    <field name="name"/>
                </tree>
            </field>
        </record>
        <record id="action_bien_so_xe" model="ir.actions.act_window">
            <field name="name">Biển số xe</field>
            <field name="res_model">bien.so.xe</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_bien_so_xe_tree"/>
        </record>

<!-- Mã xưởng -->    
    	<record id="view_ma_xuong_tree" model="ir.ui.view">
            <field name="name">ma.xuong.tree</field>
            <field name="model">ma.xuong</field>
            <field name="arch" type="xml">
                <tree string="Mã xưởng" editable='top'>
                    <field name="code"/>
                    <field name="name"/>
                </tree>
            </field>
        </record>
        <record id="action_ma_xuong" model="ir.actions.act_window">
            <field name="name">Mã xưởng</field>
            <field name="res_model">ma.xuong</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_ma_xuong_tree"/>
        </record>
        
<!-- Nợ hạng mức -->    
    	<record id="view_no_hang_muc_tree" model="ir.ui.view">
            <field name="name">no.hang.muc.tree</field>
            <field name="model">no.hang.muc</field>
            <field name="arch" type="xml">
                <tree string="Nợ hạng mức" editable='top'>
                    <field name="name"/>
                    <field name="mlg_type"/>
                    <field name="so_tien"/>
                </tree>
            </field>
        </record>
        <record id="action_no_hang_muc" model="ir.actions.act_window">
            <field name="name">Nợ hạng mức</field>
            <field name="res_model">no.hang.muc</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_no_hang_muc_tree"/>
        </record>

<!-- Chỉnh sửa journal items -->
		<act_window
            id="account.action_account_items"
            name="Journal Items"
            context="{'search_default_account_id': [active_id], 'fiscalyear': context.get('fiscalyear'),'search_default_doi_xe': 1,'search_default_thuchi': 1,'search_default_loaicongno': 1}"
            res_model="account.move.line"
            src_model="account.account"
            key2="tree_but_open"/>
            
        <record id="view_account_tree_inherit" model="ir.ui.view">
            <field name="name">account.account.tree.inherit</field>
            <field name="model">account.account</field>
            <field name="priority">2</field>
            <field name="inherit_id" ref="account.view_account_tree"/>
            <field name="arch" type="xml">
	        	<xpath expr="//field[@name='type']" position="attributes">
	        		<attribute name="invisible">1</attribute>
	        	</xpath>
            </field>
        </record>
		
<!-- QL BH Xe -->
		<record id="view_ql_bao_hiem_filter" model="ir.ui.view">
            <field name="name">no.doanh.thu.select</field>
            <field name="model">ql.bao.hiem</field>
            <field name="arch" type="xml">
                <search string="Quản lý bảo hiểm xe">
                	<field name="name"/>
                    <field name="hieu_xe"/>
                    <field name="dong_xe"/>
                    <field name="cap_noi_that"/>
                    <field name="partner_id"/>
                    <field name="loai_hinh_kd"/>
                    <field name="ngay_tham_gia"/>
                    <field name="ngay_ket_thuc"/>
                    <field name="so_hoa_don"/>
                    <field name="nha_cung_cap_bh"/>
                    <field name="chinhanh_id"/>
                    <group expand="0" string="Group By">
                    	<filter name="group_by_name" string="Biển số xe" context="{'group_by':'name'}"/>
                    	<filter name="group_by_partner_id" string="Nhà đầu tư" context="{'group_by':'partner_id'}"/>
                    	<filter name="group_by_ngay_tham_gia" string="Ngày tham gia" context="{'group_by':'ngay_tham_gia'}"/>
                    	<filter name="group_by_ngay_ket_thuc" string="Ngày kết thúc" context="{'group_by':'ngay_ket_thuc'}"/>
                    	<filter name="group_by_chinhanh_id" string="Chi nhánh" context="{'group_by':'chinhanh_id'}"/>
                    	<filter name="group_by_so_hoa_don" string="Số hóa đơn" context="{'group_by':'so_hoa_don'}"/>
                    </group>
               </search>
            </field>
        </record>
    	<record id="view_ql_bao_hiem_tree" model="ir.ui.view">
            <field name="name">no.doanh.thu.tree</field>
            <field name="model">ql.bao.hiem</field>
            <field name="arch" type="xml">
                <tree string="Quản lý bảo hiểm xe">
                	<field name="name"/>
                	<field name="chinhanh_id"/>
                	<field name="partner_id"/>
                	<field name="ngay_tham_gia"/>
                    <field name="ngay_ket_thuc"/>
                    <field name="so_hoa_don"/>
                    <field name="sotien_datra"/>
                    <field name="sotien_conlai"/>
                    <field name="nha_cung_cap_bh" invisible='1'/>
                    <field name="hieu_xe" invisible='1'/>
                    <field name="dong_xe" invisible='1'/>
                    <field name="cap_noi_that" invisible='1'/>
                    <field name="loai_hinh_kd" invisible='1'/>
                </tree>
            </field>
        </record>
        <record id="view_ql_bao_hiem_form" model="ir.ui.view">
            <field name="name">no.doanh.thu.form</field>
            <field name="model">ql.bao.hiem</field>
            <field name="arch" type="xml">
                <form string="Quản lý bảo hiểm xe" version='7.0'>
					<header>
						<field name="currency_id" invisible='1'/>
						<field name="user_id" invisible='1'/>
					</header>
                	<sheet>
                		<h1>
                			<label string='Biển số xe'/>
                			<field name="name" nolabel='1' class="oe_inline"/>
                		</h1>
	                    <group col="4" colspan="2">
	                    	<group>
		                    	<field name="chinhanh_id" readonly='1'/>
			                    <field name="partner_id" options="{'no_create': True}" domain="[('nhadautu','=',True)]" context="{'cong_no_thu':1,'loai_doituong':'nhadautu'}"/>
								<field name="ngay_tham_gia"/>
			                    <field name="hieu_xe"/>
			                    <field name="cap_noi_that"/>
		                    </group>
		                    <group>
		                    	<field name="nha_cung_cap_bh"/>
		                    	<field name="so_hoa_don"/>
		                    	<field name="ngay_ket_thuc"/>
		                    	<field name="dong_xe"/>
		                    	<field name="loai_hinh_kd"/>
		                    </group>
	                    </group>
	                    <group col="4" colspan="2">
	                    	<field name="sotien_datra" widget="monetary" options="{'currency_field': 'currency_id'}"/>
	                    	<newline/>
	                    	<field name="sotien_conlai" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    	</group>
                    </sheet>
                </form>
            </field>
        </record>
        <record id="action_ql_bao_hiem" model="ir.actions.act_window">
            <field name="name">Quản lý bảo hiểm xe</field>
            <field name="res_model">ql.bao.hiem</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_ql_bao_hiem_tree"/>
            <field name="search_view_id" ref="view_ql_bao_hiem_filter"/>
        </record>
		
<!-- Nợ doanh thu -->
		<record id="view_no_doanh_thu_filter" model="ir.ui.view">
            <field name="name">no.doanh.thu.select</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <search string="Nợ doanh thu">
                	<field name="name" string="Mã phiếu đề xuất"/>
                    <field name="date_invoice" string="Ngày giao dịch"/>
                    <field name="partner_id" string="Đối tượng"/>
                    <field name="account_id" string="Đội xe"/>
                    <field name="bai_giaoca_id" string="Bãi giao ca"/>
                    <field name="journal_id" string="Phương thức thanh toán"/>
                    <field name="chinhanh_id" string="Chi nhánh"/>
                    <field name="state"/>
                    <group expand="0" string="Group By">
                    	<filter name="group_by_partner_id" string="Đối tượng" context="{'group_by':'partner_id'}"/>
                    	<filter name="group_by_date_invoice" string="Ngày giao dịch" context="{'group_by':'date_invoice'}"/>
                    	<filter name="group_by_account_id" string="Đội xe" context="{'group_by':'account_id'}"/>
                    	<filter name="group_by_bai_giaoca_id" string="Bãi giao ca" context="{'group_by':'bai_giaoca_id'}"/>
                    	<filter name="group_by_journal_id" string="Phương thức thanh toán" context="{'group_by':'journal_id'}"/>
                    	<filter name="group_by_chinhanh_id" string="Chi nhánh" context="{'group_by':'chinhanh_id'}"/>
                    	<filter name="group_by_state" string="Trạng thái" context="{'group_by':'state'}"/>
                    </group>
               </search>
            </field>
        </record>
    	<record id="view_no_doanh_thu_tree" model="ir.ui.view">
            <field name="name">no.doanh.thu.tree</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <tree string="Nợ doanh thu">
                	<field name="name" string="Mã phiếu đề xuất"/>
                    <field name="chinhanh_id" string="Chi nhánh"/>
                    <field name="date_invoice" string="Ngày giao dịch"/>
                    <field name="partner_id" string="Đối tượng"/>
                    <field name="account_id" string="Đội xe"/>
                    <field name="bai_giaoca_id" string="Bãi giao ca"/>
                    <field name="journal_id" string="Phương thức thanh toán"/>
                    <field name="period_id" invisible='1'/>
                    <field name="currency_id" invisible='1'/>
                    <field name="amount_total" string="Tổng tiền" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="residual" string="Còn lại" groups="account.group_account_user" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="mlg_type" invisible='1'/>
                    <field name="type" invisible='1'/>
                    <field name="state"/>
                </tree>
            </field>
        </record>
        <record id="view_no_doanh_thu_form" model="ir.ui.view">
            <field name="name">no.doanh.thu.form</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <form string="Nợ doanh thu" version='7.0'>
					<header>
	                    <button name="in_phieu" type="object" string="In" class="oe_highlight" context="{'name_report':'form_no_doanh_thu_report'}"/>
	                    <button name="invoice_open" states="draft" string="Approve" class="oe_highlight" groups="base.group_user"/>
	                    <button name="invoice_open" states="proforma2" string="Approve" groups="base.group_user"/>
	                    <button name="invoice_pay_customer" type="object" string="Register Payment"
	                        attrs="{'invisible': [('state','!=','open')]}" class="oe_highlight" groups="base.group_user"/>
	                    <button name="invoice_cancel" states="draft,proforma2,open" string="Cancel Invoice" groups="base.group_no_one"/>
	                    <button name="action_cancel_draft" states="cancel" string="Reset to Draft" type="object" groups="base.group_user"/>
						<field name="state" widget="statusbar" statusbar_visible="draft,open,paid"/>
						<field name="mlg_type" invisible='1'/>
                    	<field name="type" invisible='1'/>
					</header>
                	<sheet>
                		<h1>
                			<label string='Mã phiếu đề xuất'/>
                			<field name="name" nolabel='1' class="oe_inline" readonly='1'/>
                		</h1>
	                    <group col="4" colspan="2">
	                    	<group>
		                    	<field name="chinhanh_id" string="Chi nhánh"/>
		                    	<field name="loai_doituong" string="Loại đối tượng" required='1' on_change="onchange_loaidoituong(loai_doituong)"/>
			                    <field name="partner_id" options="{'no_create': True}" domain="[('customer','=',True)]" string="Đối tượng" context="{'cong_no_thu':1,'loai_doituong':loai_doituong,'form_view_ref':loai_doituong=='taixe' and 'mlg_arap_account.view_tai_xe_form' or (loai_doituong=='nhanvienvanphong' and 'mlg_arap_account.view_nhanvienvanphong_form' or 'mlg_arap_account.view_nha_dau_tu_form')}" on_change="onchange_doituong(partner_id,loai_doituong)"/>
			                    <field name="chinhanh_ndt_id" invisible='1' context="{'cong_no_thu':1,'partner_id':partner_id}" domain="[('parent_id.code','=','1')]" on_change="onchange_chinhanh_ndt(chinhanh_ndt_id,partner_id)" attrs="{'invisible':[('loai_doituong','!=','nhadautu')],'required':[('loai_doituong','=','nhadautu')]}"/>
			                    <field name="journal_id" invisible='1' string="Phương thức thanh toán" widget ="selection" on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)"/>
		                    </group>
		                    <group>
			                    <field name="date_invoice" string="Ngày giao dịch" required='1'/>
			                    <field name="account_id" string="Đội xe" context="{'show_doixe':1,'cong_no_thu_nhadautu':1,'chinhanh_ndt_id':chinhanh_ndt_id,'partner_id':partner_id}" attrs="{'readonly':[('loai_doituong','=','taixe')],'invisible':[('loai_doituong','!=','taixe')]}"/>
			                    <field name="bai_giaoca_id" string="Bãi giao ca" attrs="{'invisible':[('loai_doituong','!=','taixe')]}"/>
			                    <field name="cmnd" attrs="{'invisible':[('loai_doituong','!=','nhadautu')]}"/>
			                    <field name="giayphep_kinhdoanh" attrs="{'invisible':[('loai_doituong','!=','nhadautu')]}"/>
		                    </group>
	                    </group>
                    	<group col="4" colspan="2">
	                    	<field name="so_tien" required='1' on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)" widget="monetary" options="{'currency_field': 'currency_id'}"/>
	                    	<newline/>
	                    	<field name="residual" string="Còn lại" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    	</group>
                    	<group>
                    		<field name="dien_giai" placeholder="Diễn giải ..." nolabel='1' on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)"/>
                    	</group>
	                    <notebook>
		                    <page string="Payments" groups="base.group_user">
	                            <field name="payment_ids">
	                                <tree string="Payments">
	                                    <field name="date" string="Ngày thanh toán"/>
	                                    <field name="move_id" string="Bút toán"/>
	                                    <field name="journal_id" groups="base.group_user" string="Phương thức thanh toán"/>
	                                    <field name="debit" string="Nợ"/>
	                                    <field name="credit" string="Có"/>
	                                    <field name="amount_currency" groups="base.group_multi_currency"/>
	                                    <field name="currency_id" groups="base.group_multi_currency"/>
	                                </tree>
	                            </field>
	                        </page>
	                        <page string="Chi tiết công nợ" invisible='1'>
			                    <field name="invoice_line" context="{'journal_id': journal_id}">
									<tree editable='bottom'>
										<field name="name" string="Diễn giải"/>
										<field name="account_id" invisible='0'/>
										<field name="price_unit" string="Số tiền"/>
									</tree>			                    
			                    </field>
			                    <field name="period_id" invisible='1'/>
			                    <field name="company_id" invisible='1'/>
			                    <field name="currency_id" invisible='1'/>
			                    <group class="oe_subtotal_footer oe_right">
	                                <field name="amount_total" string="Tổng tiền" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
	                            </group>
	                            <div class="oe_clear"/>
		                    </page>
	                    </notebook>
                    </sheet>
                    <div class="oe_chatter">
		                <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
		                <field name="message_ids" widget="mail_thread"/>
		            </div>
                </form>
            </field>
        </record>
        <record id="action_no_doanh_thu" model="ir.actions.act_window">
            <field name="name">Nợ doanh thu</field>
            <field name="res_model">account.invoice</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_no_doanh_thu_tree"/>
            <field name="search_view_id" ref="view_no_doanh_thu_filter"/>
            <field name="domain">[('mlg_type','=','no_doanh_thu')]</field>
            <field name="context">{'default_mlg_type': 'no_doanh_thu', 'default_type': 'out_invoice'}</field>
        </record>
		<record id="action_no_doanh_thu1" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_no_doanh_thu_tree"/>
            <field name="act_window_id" ref="action_no_doanh_thu"/>
        </record>
        <record id="action_no_doanh_thu2" model="ir.actions.act_window.view">
            <field eval="2" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_no_doanh_thu_form"/>
            <field name="act_window_id" ref="action_no_doanh_thu"/>
        </record>

<!-- Chi hộ điện thoại -->
		<record id="view_chi_ho_dien_thoai_filter" model="ir.ui.view">
            <field name="name">chi.ho.dien.thoai.select</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <search string="Search Invoice">
                	<field name="name" string="Mã phiếu đề xuất"/>
                    <field name="date_invoice" string="Ngày giao dịch"/>
                    <field name="partner_id" string="Đối tượng"/>
                    <field name="account_id" string="Đội xe"/>
                    <field name="chinhanh_id" string="Chi nhánh"/>
                    <field name="journal_id" string="Loại giao dịch"/>
                    <field name="state"/>
                    <group expand="0" string="Group By">
                    	<filter name="group_by_partner_id" string="Đối tượng" context="{'group_by':'partner_id'}"/>
                    	<filter name="group_by_date_invoice" string="Ngày giao dịch" context="{'group_by':'date_invoice'}"/>
                    	<filter name="group_by_account_id" string="Đội xe" context="{'group_by':'account_id'}"/>
                    	<filter name="group_by_bai_giaoca_id" string="Bãi giao ca" context="{'group_by':'bai_giaoca_id'}"/>
                    	<filter name="group_by_journal_id" string="Loại giao dịch" context="{'group_by':'journal_id'}"/>
                    	<filter name="group_by_chinhanh_id" string="Chi nhánh" context="{'group_by':'chinhanh_id'}"/>
                    	<filter name="group_by_state" string="Trạng thái" context="{'group_by':'state'}"/>
                    </group>
               </search>
            </field>
        </record>
    	<record id="view_chi_ho_dien_thoai_tree" model="ir.ui.view">
            <field name="name">chi.ho.dien.thoai.tree</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <tree string="Chi hộ điện thoại">
                	<field name="name" string="Mã phiếu đề xuất"/>
                	<field name="chinhanh_id" string="Chi nhánh"/>
                    <field name="date_invoice" string="Ngày giao dịch"/>
                    <field name="partner_id" string="Đối tượng"/>
                    <field name="account_id" string="Tên Phòng ban/Đội xe"/>
                    <field name="so_hoa_don" string="Số hóa đơn" />
                    <field name="journal_id" string="Loại giao dịch"/>
                    <field name="mlg_type" invisible='1'/>
                    <field name="period_id" invisible='1'/>
                    <field name="currency_id" invisible='1'/>
                    <field name="amount_total" string="Tổng tiền" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="residual" string="Còn lại" groups="account.group_account_user" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="type" invisible='1'/>
                    <field name="state"/>
                </tree>
            </field>
        </record>
        <record id="view_chi_ho_dien_thoai_form" model="ir.ui.view">
            <field name="name">chi.ho.dien.thoai.form</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <form string="Chi hộ điện thoại" version='7.0'>
					<header>
	                    <button name="invoice_open" states="draft" string="Approve" class="oe_highlight" groups="base.group_user"/>
	                    <button name="invoice_open" states="proforma2" string="Approve" groups="base.group_user"/>
	                    <button name="invoice_pay_customer" type="object" string="Register Payment"
	                        attrs="{'invisible': [('state','!=','open')]}" class="oe_highlight" groups="base.group_user"/>
	                    <button name="invoice_cancel" states="draft,proforma2,open" string="Cancel Invoice" groups="base.group_no_one"/>
	                    <button name="action_cancel_draft" states="cancel" string="Reset to Draft" type="object" groups="base.group_user"/>
						<field name="state" widget="statusbar" statusbar_visible="draft,open,paid"/>
						<field name="mlg_type" invisible='1'/>
                    	<field name="type" invisible='1'/>
					</header>
                	<sheet>
                		<h1>
                			<label string='Mã phiếu đề xuất'/>
                			<field name="name" nolabel='1' class="oe_inline" readonly='1'/>
                		</h1>
                		<group col="4" colspan="2">
	                    	<group>
		                    	<field name="chinhanh_id" string="Chi nhánh"/>
		                    	<field name="loai_doituong" string="Loại đối tượng" required='1' on_change="onchange_loaidoituong(loai_doituong)"/>
			                    <field name="partner_id" options="{'no_create': True}" domain="[('customer','=',True)]" string="Đối tượng" context="{'cong_no_thu':1,'loai_doituong':loai_doituong,'form_view_ref':loai_doituong=='taixe' and 'mlg_arap_account.view_tai_xe_form' or (loai_doituong=='nhanvienvanphong' and 'mlg_arap_account.view_nhanvienvanphong_form' or 'mlg_arap_account.view_nha_dau_tu_form')}" on_change="onchange_doituong(partner_id,loai_doituong)"/>
			                    <field name="chinhanh_ndt_id" invisible='1' context="{'cong_no_thu':1,'partner_id':partner_id}" domain="[('parent_id.code','=','1')]" on_change="onchange_chinhanh_ndt(chinhanh_ndt_id,partner_id)" attrs="{'invisible':[('loai_doituong','!=','nhadautu')],'required':[('loai_doituong','=','nhadautu')]}"/>
			                    <field name="journal_id" invisible='1' string="Phương thức thanh toán" widget ="selection" on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)"/>
		                    </group>
		                    <group>
			                    <field name="date_invoice" string="Ngày giao dịch" required='1'/>
			                    <field name="account_id" string="Đội xe" context="{'show_doixe':1,'cong_no_thu_nhadautu':1,'chinhanh_ndt_id':chinhanh_ndt_id,'partner_id':partner_id}" attrs="{'readonly':[('loai_doituong','=','taixe')],'invisible':[('loai_doituong','!=','taixe')]}"/>
			                    <field name="bai_giaoca_id" string="Bãi giao ca" attrs="{'invisible':[('loai_doituong','!=','taixe')]}"/>
			                    <field name="cmnd" attrs="{'invisible':[('loai_doituong','!=','nhadautu')]}"/>
			                    <field name="giayphep_kinhdoanh" attrs="{'invisible':[('loai_doituong','!=','nhadautu')]}"/>
			                    <field name="so_hoa_don"/>
		                    </group>
	                    </group>
                    	<group col="4" colspan="2">
	                    	<field name="so_tien" required='1' on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)" widget="monetary" options="{'currency_field': 'currency_id'}"/>
	                    	<newline/>
	                    	<field name="residual" string="Còn lại" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    	</group>
                    	<group>
                    		<field name="dien_giai" placeholder="Diễn giải ..." nolabel='1' on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)"/>
                    	</group>
	                    <notebook>
		                    <page string="Payments" groups="base.group_user">
	                            <field name="payment_ids">
	                                <tree string="Payments">
	                                    <field name="date" string="Ngày thanh toán"/>
	                                    <field name="move_id" string="Bút toán"/>
	                                    <field name="journal_id" groups="base.group_user" string="Phương thức thanh toán"/>
	                                    <field name="debit" string="Nợ"/>
	                                    <field name="credit" string="Có"/>
	                                    <field name="amount_currency" groups="base.group_multi_currency"/>
	                                    <field name="currency_id" groups="base.group_multi_currency"/>
	                                </tree>
	                            </field>
	                        </page>
	                        <page string="Chi tiết công nợ" invisible='1'>
			                    <field name="invoice_line" context="{'journal_id': journal_id}">
									<tree editable='bottom'>
										<field name="name" string="Diễn giải"/>
										<field name="account_id" invisible='0'/>
										<field name="price_unit" string="Số tiền"/>
									</tree>			                    
			                    </field>
			                    <field name="period_id" invisible='1'/>
			                    <field name="company_id" invisible='1'/>
			                    <field name="currency_id" invisible='1'/>
			                    <group class="oe_subtotal_footer oe_right">
	                                <field name="amount_total" string="Tổng tiền" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
	                            </group>
	                            <div class="oe_clear"/>
		                    </page>
	                    </notebook>
                    </sheet>
                    <div class="oe_chatter">
		                <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
		                <field name="message_ids" widget="mail_thread"/>
		            </div>
                </form>
            </field>
        </record>
        <record id="action_chi_ho_dien_thoai" model="ir.actions.act_window">
            <field name="name">Chi hộ điện thoại</field>
            <field name="res_model">account.invoice</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_chi_ho_dien_thoai_tree"/>
            <field name="search_view_id" ref="view_chi_ho_dien_thoai_filter"/>
            <field name="domain">[('mlg_type','=','chi_ho_dien_thoai')]</field>
            <field name="context">{'default_mlg_type': 'chi_ho_dien_thoai', 'default_type': 'out_invoice'}</field>
        </record>
		<record id="action_chi_ho_dien_thoai1" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_chi_ho_dien_thoai_tree"/>
            <field name="act_window_id" ref="action_chi_ho_dien_thoai"/>
        </record>
        <record id="action_chi_ho_dien_thoai2" model="ir.actions.act_window.view">
            <field eval="2" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_chi_ho_dien_thoai_form"/>
            <field name="act_window_id" ref="action_chi_ho_dien_thoai"/>
        </record>
        
<!-- Phải thu bảo hiểm -->
		<record id="view_phai_thu_bao_hiem_filter" model="ir.ui.view">
            <field name="name">phai.thu.bao.hiem.select</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <search string="Search Invoice">
                	<field name="name" string="Mã phiếu đề xuất"/>
                    <field name="date_invoice" string="Ngày giao dịch"/>
                    <field name="partner_id" string="Đối tượng"/>
                    <field name="account_id" string="Tên Phòng ban/Đội xe"/>
                    <field name="chinhanh_id" string="Chi nhánh"/>
                    <field name="journal_id" string="Phương thức thanh toán"/>
                    <field name="so_hop_dong"/>
                    <field name="state"/>
                    <group expand="0" string="Group By">
                    	<filter name="group_by_partner_id" string="Đối tượng" context="{'group_by':'partner_id'}"/>
                    	<filter name="group_by_date_invoice" string="Ngày giao dịch" context="{'group_by':'date_invoice'}"/>
                    	<filter name="group_by_account_id" string="Tên Phòng ban/Đội xe" context="{'group_by':'account_id'}"/>
                    	<filter name="group_by_journal_id" string="Phương thức thanh toán" context="{'group_by':'journal_id'}"/>
                    	<filter name="group_by_chinhanh_id" string="Chi nhánh" context="{'group_by':'chinhanh_id'}"/>
                    	<filter name="group_by_state" string="Trạng thái" context="{'group_by':'state'}"/>
                    </group>
               </search>
            </field>
        </record>
    	<record id="view_phai_thu_bao_hiem_tree" model="ir.ui.view">
            <field name="name">phai.thu.bao.hiem.tree</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <tree string="Phải thu bảo hiểm">
                	<field name="name" string="Mã phiếu đề xuất"/>
                	<field name="chinhanh_id" string="Chi nhánh"/>
                    <field name="date_invoice" string="Ngày giao dịch"/>
                    <field name="partner_id" string="Đối tượng"/>
                    <field name="account_id" string="Tên Phòng ban/Đội xe"/>
                    <field name="so_hop_dong" string="Số hợp đồng"/>
                    <field name="journal_id" string="Phương thức thanh toán"/>
                    <field name="mlg_type" invisible='1'/>
                    <field name="period_id" invisible='1'/>
                    <field name="currency_id" invisible='1'/>
                    <field name="amount_total" string="Tổng tiền" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="residual" string="Còn lại" groups="account.group_account_user" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="type" invisible='1'/>
                    <field name="state"/>
                </tree>
            </field>
        </record>
        <record id="view_phai_thu_bao_hiem_form" model="ir.ui.view">
            <field name="name">phai.thu.bao.hiem.form</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <form string="Phải thu bảo hiểm" version='7.0'>
					<header>
	                    <button name="invoice_open" states="draft" string="Approve" class="oe_highlight" groups="base.group_user"/>
	                    <button name="invoice_open" states="proforma2" string="Approve" groups="base.group_user"/>
	                    <button name="invoice_pay_customer" type="object" string="Register Payment"
	                        attrs="{'invisible': [('state','!=','open')]}" class="oe_highlight" groups="base.group_user"/>
	                    <button name="invoice_cancel" states="draft,proforma2,open" string="Cancel Invoice" groups="base.group_no_one"/>
	                    <button name="action_cancel_draft" states="cancel" string="Reset to Draft" type="object" groups="base.group_user"/>
						<field name="state" widget="statusbar" statusbar_visible="draft,open,paid"/>
						<field name="mlg_type" invisible='1'/>
                    	<field name="type" invisible='1'/>
					</header>
                	<sheet>
                		<h1>
                			<label string='Mã phiếu đề xuất'/>
                			<field name="name" nolabel='1' class="oe_inline" readonly='1'/>
                		</h1>
	                    <group col="4" colspan="2">
	                    	<group>
		                    	<field name="chinhanh_id" string="Chi nhánh"/>
		                    	<field name="loai_doituong" string="Loại đối tượng" required='1' on_change="onchange_loaidoituong(loai_doituong)"/>
			                    <field name="partner_id" options="{'no_create': True}" domain="[('customer','=',True)]" string="Đối tượng" context="{'cong_no_thu':1,'loai_doituong':loai_doituong,'form_view_ref':loai_doituong=='taixe' and 'mlg_arap_account.view_tai_xe_form' or (loai_doituong=='nhanvienvanphong' and 'mlg_arap_account.view_nhanvienvanphong_form' or 'mlg_arap_account.view_nha_dau_tu_form')}" on_change="onchange_doituong(partner_id,loai_doituong)"/>
			                    <field name="chinhanh_ndt_id" invisible='1' context="{'cong_no_thu':1,'partner_id':partner_id}" domain="[('parent_id.code','=','1')]" on_change="onchange_chinhanh_ndt(chinhanh_ndt_id,partner_id)" attrs="{'invisible':[('loai_doituong','!=','nhadautu')],'required':[('loai_doituong','=','nhadautu')]}"/>
			                    <field name="journal_id" invisible='1' string="Phương thức thanh toán" widget ="selection" on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)"/>
		                    </group>
		                    <group>
			                    <field name="date_invoice" string="Ngày giao dịch" required='1'/>
			                    <field name="account_id" string="Đội xe" context="{'show_doixe':1,'cong_no_thu_nhadautu':1,'chinhanh_ndt_id':chinhanh_ndt_id,'partner_id':partner_id}" attrs="{'readonly':[('loai_doituong','=','taixe')],'invisible':[('loai_doituong','!=','taixe')]}"/>
			                    <field name="bai_giaoca_id" string="Bãi giao ca" attrs="{'invisible':[('loai_doituong','!=','taixe')]}"/>
			                    <field name="bien_so_xe"/>
			                    <field name="cmnd" attrs="{'invisible':[('loai_doituong','!=','nhadautu')]}"/>
			                    <field name="giayphep_kinhdoanh" attrs="{'invisible':[('loai_doituong','!=','nhadautu')]}"/>
			                    <field name="so_hoa_don"/>
		                    </group>
	                    </group>
                    	<group col="4" colspan="2">
	                    	<field name="so_tien" required='1' on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)" widget="monetary" options="{'currency_field': 'currency_id'}"/>
	                    	<newline/>
	                    	<field name="residual" string="Còn lại" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    	</group>
                    	<group>
                    		<field name="dien_giai" placeholder="Diễn giải ..." nolabel='1' on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)"/>
                    	</group>
	                    <notebook>
		                    <page string="Payments" groups="base.group_user">
	                            <field name="payment_ids">
	                                <tree string="Payments">
	                                    <field name="date" string="Ngày thanh toán"/>
	                                    <field name="move_id" string="Bút toán"/>
	                                    <field name="journal_id" groups="base.group_user" string="Phương thức thanh toán"/>
	                                    <field name="debit" string="Nợ"/>
	                                    <field name="credit" string="Có"/>
	                                    <field name="amount_currency" groups="base.group_multi_currency"/>
	                                    <field name="currency_id" groups="base.group_multi_currency"/>
	                                </tree>
	                            </field>
	                        </page>
	                        <page string="Chi tiết công nợ" invisible='1'>
			                    <field name="invoice_line" context="{'journal_id': journal_id}">
									<tree editable='bottom'>
										<field name="name" string="Diễn giải"/>
										<field name="account_id" invisible='0'/>
										<field name="price_unit" string="Số tiền"/>
									</tree>			                    
			                    </field>
			                    <field name="period_id" invisible='1'/>
			                    <field name="company_id" invisible='1'/>
			                    <field name="currency_id" invisible='1'/>
			                    <group class="oe_subtotal_footer oe_right">
	                                <field name="amount_total" string="Tổng tiền" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
	                            </group>
	                            <div class="oe_clear"/>
		                    </page>
	                    </notebook>
                    </sheet>
                    <div class="oe_chatter">
		                <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
		                <field name="message_ids" widget="mail_thread"/>
		            </div>
                </form>
            </field>
        </record>
        <record id="action_phai_thu_bao_hiem" model="ir.actions.act_window">
            <field name="name">Phải thu bảo hiểm</field>
            <field name="res_model">account.invoice</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_phai_thu_bao_hiem_tree"/>
            <field name="search_view_id" ref="view_phai_thu_bao_hiem_filter"/>
            <field name="domain">[('mlg_type','=','phai_thu_bao_hiem')]</field>
            <field name="context">{'default_mlg_type': 'phai_thu_bao_hiem', 'default_type': 'out_invoice'}</field>
        </record>
		<record id="action_phai_thu_bao_hiem1" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_phai_thu_bao_hiem_tree"/>
            <field name="act_window_id" ref="action_phai_thu_bao_hiem"/>
        </record>
        <record id="action_phai_thu_bao_hiem2" model="ir.actions.act_window.view">
            <field eval="2" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_phai_thu_bao_hiem_form"/>
            <field name="act_window_id" ref="action_phai_thu_bao_hiem"/>
        </record>

<!-- Phải thu ký quỹ -->
		<record id="view_phai_thu_ky_quy_filter" model="ir.ui.view">
            <field name="name">phai.thu.ky.quy.select</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <search string="Search Invoice">
                	<field name="name" string="Mã phiếu đề xuất"/>
                    <field name="date_invoice" string="Ngày giao dịch"/>
                    <field name="partner_id" string="Đối tượng"/>
                    <field name="account_id" string="Tên Phòng ban/Đội xe"/>
                    <field name="chinhanh_id" string="Chi nhánh"/>
                    <field name="journal_id" string="Phương thức thanh toán"/>
                    <field name="state"/>
                    <group expand="0" string="Group By">
                    	<filter name="group_by_partner_id" string="Đối tượng" context="{'group_by':'partner_id'}"/>
                    	<filter name="group_by_date_invoice" string="Ngày giao dịch" context="{'group_by':'date_invoice'}"/>
                    	<filter name="group_by_account_id" string="Tên Phòng ban/Đội xe" context="{'group_by':'account_id'}"/>
                    	<filter name="group_by_journal_id" string="Phương thức thanh toán" context="{'group_by':'journal_id'}"/>
                    	<filter name="group_by_chinhanh_id" string="Chi nhánh" context="{'group_by':'chinhanh_id'}"/>
                    	<filter name="group_by_state" string="Trạng thái" context="{'group_by':'state'}"/>
                    </group>
               </search>
            </field>
        </record>
    	<record id="view_phai_thu_ky_quy_tree" model="ir.ui.view">
            <field name="name">phai.thu.ky.quy.tree</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <tree string="Phải thu ký quỹ">
                	<field name="name" string="Mã phiếu đề xuất"/>
                	<field name="chinhanh_id" string="Chi nhánh"/>
                    <field name="date_invoice" string="Ngày giao dịch"/>
                    <field name="partner_id" string="Đối tượng"/>
                    <field name="account_id" string="Tên Phòng ban/Đội xe"/>
                    <field name="bai_giaoca_id" string="Bãi giao ca"/>
                    <field name="journal_id" string="Phương thức thanh toán"/>
                    <field name="loai_kyquy_id" string="Loại ký quỹ"/>
                    <field name="mlg_type" invisible='1'/>
                    <field name="period_id" invisible='1'/>
                    <field name="currency_id" invisible='1'/>
                    <field name="amount_total" string="Tổng tiền" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="residual" string="Còn lại" groups="account.group_account_user" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="type" invisible='1'/>
                    <field name="state"/>
                </tree>
            </field>
        </record>
        <record id="view_phai_thu_ky_quy_form" model="ir.ui.view">
            <field name="name">phai.thu.ky.quy.form</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <form string="Phải thu ký quỹ" version='7.0'>
					<header>
	                    <button name="invoice_open" states="draft" string="Approve" class="oe_highlight" groups="base.group_user"/>
	                    <button name="invoice_open" states="proforma2" string="Approve" groups="base.group_user"/>
	                    <button name="invoice_pay_customer" type="object" string="Register Payment"
	                        attrs="{'invisible': [('state','!=','open')]}" class="oe_highlight" groups="base.group_user"/>
	                    <button name="invoice_cancel" states="draft,proforma2,open" string="Cancel Invoice" groups="base.group_no_one"/>
	                    <button name="action_cancel_draft" states="cancel" string="Reset to Draft" type="object" groups="base.group_user"/>
						<field name="state" widget="statusbar" statusbar_visible="draft,open,paid"/>
						<field name="mlg_type" invisible='1'/>
                    	<field name="type" invisible='1'/>
                    	<field name="loai_doituong" invisible='1'/>
					</header>
                	<sheet>
                		<h1>
                			<label string='Mã phiếu đề xuất'/>
                			<field name="name" nolabel='1' class="oe_inline" readonly='1'/>
                		</h1>
	                    <group col="4" colspan="2">
	                    	<group>
		                    	<field name="chinhanh_id" string="Chi nhánh"/>
		                    	<field name="loai_doituong" string="Loại đối tượng" required='1' on_change="onchange_loaidoituong(loai_doituong)"/>
			                    <field name="partner_id" options="{'no_create': True}" domain="[('customer','=',True)]" string="Đối tượng" context="{'cong_no_thu':1,'loai_doituong':loai_doituong,'form_view_ref':loai_doituong=='taixe' and 'mlg_arap_account.view_tai_xe_form' or (loai_doituong=='nhanvienvanphong' and 'mlg_arap_account.view_nhanvienvanphong_form' or 'mlg_arap_account.view_nha_dau_tu_form')}" on_change="onchange_doituong(partner_id,loai_doituong)"/>
			                    <field name="chinhanh_ndt_id" invisible='1' context="{'cong_no_thu':1,'partner_id':partner_id}" domain="[('parent_id.code','=','1')]" on_change="onchange_chinhanh_ndt(chinhanh_ndt_id,partner_id)" attrs="{'invisible':[('loai_doituong','!=','nhadautu')],'required':[('loai_doituong','=','nhadautu')]}"/>
			                    <field name="journal_id" invisible='1' string="Phương thức thanh toán" widget ="selection" on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)"/>
		                    </group>
		                    <group>
			                    <field name="date_invoice" string="Ngày giao dịch" required='1'/>
			                    <field name="account_id" string="Đội xe" context="{'show_doixe':1,'cong_no_thu_nhadautu':1,'chinhanh_ndt_id':chinhanh_ndt_id,'partner_id':partner_id}" attrs="{'readonly':[('loai_doituong','=','taixe')],'invisible':[('loai_doituong','!=','taixe')]}"/>
			                    <field name="bai_giaoca_id" string="Bãi giao ca" attrs="{'invisible':[('loai_doituong','!=','taixe')]}"/>
			                    <field name="bien_so_xe"/>
			                    <field name="cmnd" attrs="{'invisible':[('loai_doituong','!=','nhadautu')]}"/>
			                    <field name="giayphep_kinhdoanh" attrs="{'invisible':[('loai_doituong','!=','nhadautu')]}"/>
			                    <field name="loai_kyquy_id" options="{'no_create': True}"/>
		                    </group>
	                    </group>
                    	<group col="4" colspan="2">
	                    	<field name="so_tien" required='1' on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)" widget="monetary" options="{'currency_field': 'currency_id'}"/>
	                    	<newline/>
	                    	<field name="residual" string="Còn lại" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    	</group>
                    	<group>
                    		<field name="dien_giai" placeholder="Diễn giải ..." nolabel='1' on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)"/>
                    	</group>
	                    <notebook>
		                    <page string="Payments" groups="base.group_user">
	                            <field name="payment_ids">
	                                <tree string="Payments">
	                                    <field name="date" string="Ngày thanh toán"/>
	                                    <field name="move_id" string="Bút toán"/>
	                                    <field name="journal_id" groups="base.group_user" string="Phương thức thanh toán"/>
	                                    <field name="debit" string="Nợ"/>
	                                    <field name="credit" string="Có"/>
	                                    <field name="amount_currency" groups="base.group_multi_currency"/>
	                                    <field name="currency_id" groups="base.group_multi_currency"/>
	                                </tree>
	                            </field>
	                        </page>
	                        <page string="Chi tiết công nợ" invisible='1'>
			                    <field name="invoice_line" context="{'journal_id': journal_id}">
									<tree editable='bottom'>
										<field name="name" string="Diễn giải"/>
										<field name="account_id" invisible='0'/>
										<field name="price_unit" string="Số tiền"/>
									</tree>			                    
			                    </field>
			                    <field name="period_id" invisible='1'/>
			                    <field name="company_id" invisible='1'/>
			                    <field name="currency_id" invisible='1'/>
			                    <group class="oe_subtotal_footer oe_right">
	                                <field name="amount_total" string="Tổng tiền" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
	                            </group>
	                            <div class="oe_clear"/>
		                    </page>
	                    </notebook>
                    </sheet>
                    <div class="oe_chatter">
		                <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
		                <field name="message_ids" widget="mail_thread"/>
		            </div>
                </form>
            </field>
        </record>
        <record id="action_phai_thu_ky_quy" model="ir.actions.act_window">
            <field name="name">Phải thu ký quỹ</field>
            <field name="res_model">account.invoice</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_phai_thu_ky_quy_tree"/>
            <field name="search_view_id" ref="view_phai_thu_ky_quy_filter"/>
            <field name="domain">[('mlg_type','=','phai_thu_ky_quy')]</field>
            <field name="context">{'default_mlg_type': 'phai_thu_ky_quy', 'default_type': 'out_invoice'}</field>
        </record>
		<record id="action_phai_thu_ky_quy1" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_phai_thu_ky_quy_tree"/>
            <field name="act_window_id" ref="action_phai_thu_ky_quy"/>
        </record>
        <record id="action_phai_thu_ky_quy2" model="ir.actions.act_window.view">
            <field eval="2" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_phai_thu_ky_quy_form"/>
            <field name="act_window_id" ref="action_phai_thu_ky_quy"/>
        </record>
        
<!-- Phạt vi phạm-->
		<record id="view_phat_vi_pham_filter" model="ir.ui.view">
            <field name="name">phat.vi.pham.select</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <search string="Search Invoice">
                	<field name="name" string="Mã phiếu đề xuất"/>
                	<field name="chinhanh_id" string="Chi nhánh"/>
                    <field name="date_invoice" string="Ngày giao dịch"/>
                    <field name="partner_id" string="Đối tượng"/>
                    <field name="account_id" string="Tên Phòng ban/Đội xe"/>
                    <field name="state"/>
                    <group expand="0" string="Group By">
                    	<filter name="group_by_partner_id" string="Đối tượng" context="{'group_by':'partner_id'}"/>
                    	<filter name="group_by_date_invoice" string="Ngày giao dịch" context="{'group_by':'date_invoice'}"/>
                    	<filter name="group_by_account_id" string="Tên Phòng ban/Đội xe" context="{'group_by':'account_id'}"/>
                    	<filter name="group_by_loai_vipham_id" string="Loại vi phạm" context="{'group_by':'loai_vipham_id'}"/>
                    	<filter name="group_by_chinhanh_id" string="Chi nhánh" context="{'group_by':'chinhanh_id'}"/>
                    	<filter name="group_by_state" string="Trạng thái" context="{'group_by':'state'}"/>
                    </group>
               </search>
            </field>
        </record>
    	<record id="view_phat_vi_pham_tree" model="ir.ui.view">
            <field name="name">phat.vi.pham.tree</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <tree string="Phạt vi phạm">
                	<field name="name" string="Mã phiếu đề xuất"/>
                	<field name="chinhanh_id" string="Chi nhánh"/>
                    <field name="date_invoice" string="Ngày giao dịch"/>
                    <field name="partner_id" string="Đối tượng"/>
                    <field name="account_id" string="Tên Phòng ban/Đội xe"/>
                    <field name="so_bien_ban_vi_pham" string="Số biên bản vi phạm"/>
                    <field name="loai_vipham_id" string="Loại vi phạm"/>
                    <field name="mlg_type" invisible='1'/>
                    <field name="period_id" invisible='1'/>
                    <field name="currency_id" invisible='1'/>
                    <field name="amount_total" string="Tổng tiền" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="residual" string="Còn lại" groups="account.group_account_user" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="type" invisible='1'/>
                    <field name="state"/>
                </tree>
            </field>
        </record>
        <record id="view_phat_vi_pham_form" model="ir.ui.view">
            <field name="name">phat.vi.pham.form</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <form string="Phạt vi phạm" version='7.0'>
					<header>
	                    <button name="invoice_open" states="draft" string="Approve" class="oe_highlight" groups="base.group_user"/>
	                    <button name="invoice_open" states="proforma2" string="Approve" groups="base.group_user"/>
	                    <button name="invoice_pay_customer" type="object" string="Register Payment"
	                        attrs="{'invisible': [('state','!=','open')]}" class="oe_highlight" groups="base.group_user"/>
	                    <button name="invoice_cancel" states="draft,proforma2,open" string="Cancel Invoice" groups="base.group_no_one"/>
	                    <button name="action_cancel_draft" states="cancel" string="Reset to Draft" type="object" groups="base.group_user"/>
						<field name="state" widget="statusbar" statusbar_visible="draft,open,paid"/>
						<field name="mlg_type" invisible='1'/>
                    	<field name="type" invisible='1'/>
					</header>
                	<sheet>
                		<h1>
                			<label string='Mã phiếu đề xuất'/>
                			<field name="name" nolabel='1' class="oe_inline" readonly='1'/>
                		</h1>
	                    <group col="4" colspan="2">
	                    	<group>
		                    	<field name="chinhanh_id" string="Chi nhánh"/>
		                    	<field name="loai_doituong" string="Loại đối tượng" required='1' on_change="onchange_loaidoituong(loai_doituong)"/>
			                    <field name="partner_id" options="{'no_create': True}" domain="[('customer','=',True)]" string="Đối tượng" context="{'cong_no_thu':1,'loai_doituong':loai_doituong,'form_view_ref':loai_doituong=='taixe' and 'mlg_arap_account.view_tai_xe_form' or (loai_doituong=='nhanvienvanphong' and 'mlg_arap_account.view_nhanvienvanphong_form' or 'mlg_arap_account.view_nha_dau_tu_form')}" on_change="onchange_doituong(partner_id,loai_doituong)"/>
			                    <field name="chinhanh_ndt_id" invisible='1' context="{'cong_no_thu':1,'partner_id':partner_id}" domain="[('parent_id.code','=','1')]" on_change="onchange_chinhanh_ndt(chinhanh_ndt_id,partner_id)" attrs="{'invisible':[('loai_doituong','!=','nhadautu')],'required':[('loai_doituong','=','nhadautu')]}"/>
			                    <field name="journal_id" invisible='1' string="Phương thức thanh toán" widget ="selection" on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)"/>
		                    </group>
		                    <group>
			                    <field name="date_invoice" string="Ngày giao dịch" required='1'/>
			                    <field name="account_id" string="Đội xe" context="{'show_doixe':1,'cong_no_thu_nhadautu':1,'chinhanh_ndt_id':chinhanh_ndt_id,'partner_id':partner_id}" attrs="{'readonly':[('loai_doituong','=','taixe')],'invisible':[('loai_doituong','!=','taixe')]}"/>
			                    <field name="bai_giaoca_id" string="Bãi giao ca" attrs="{'invisible':[('loai_doituong','!=','taixe')]}"/>
			                    <field name="cmnd" attrs="{'invisible':[('loai_doituong','!=','nhadautu')]}"/>
			                    <field name="giayphep_kinhdoanh" attrs="{'invisible':[('loai_doituong','!=','nhadautu')]}"/>
			                    <field name="loai_vipham_id" options="{'no_create': True}"/>
	                    		<field name="ngay_vi_pham"/>
	                    		<field name="so_bien_ban_vi_pham"/>
		                    </group>
	                    </group>
                    	<group col="4" colspan="2">
	                    	<field name="so_tien" required='1' on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)" widget="monetary" options="{'currency_field': 'currency_id'}"/>
	                    	<newline/>
	                    	<field name="residual" string="Còn lại" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    	</group>
                    	<group>
                    		<field name="dien_giai" placeholder="Diễn giải ..." nolabel='1' on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)"/>
                    	</group>
	                    <notebook>
		                    <page string="Payments" groups="base.group_user">
	                            <field name="payment_ids">
	                                <tree string="Payments">
	                                    <field name="date" string="Ngày thanh toán"/>
	                                    <field name="move_id" string="Bút toán"/>
	                                    <field name="journal_id" groups="base.group_user" string="Phương thức thanh toán"/>
	                                    <field name="debit" string="Nợ"/>
	                                    <field name="credit" string="Có"/>
	                                    <field name="amount_currency" groups="base.group_multi_currency"/>
	                                    <field name="currency_id" groups="base.group_multi_currency"/>
	                                </tree>
	                            </field>
	                        </page>
	                        <page string="Chi tiết công nợ" invisible='1'>
			                    <field name="invoice_line" context="{'journal_id': journal_id}">
									<tree editable='bottom'>
										<field name="name" string="Diễn giải"/>
										<field name="account_id" invisible='0'/>
										<field name="price_unit" string="Số tiền"/>
									</tree>			                    
			                    </field>
			                    <field name="period_id" invisible='1'/>
			                    <field name="company_id" invisible='1'/>
			                    <field name="currency_id" invisible='1'/>
			                    <group class="oe_subtotal_footer oe_right">
	                                <field name="amount_total" string="Tổng tiền" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
	                            </group>
	                            <div class="oe_clear"/>
		                    </page>
	                    </notebook>
                    </sheet>
                    <div class="oe_chatter">
		                <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
		                <field name="message_ids" widget="mail_thread"/>
		            </div>
                </form>
            </field>
        </record>
        <record id="action_phat_vi_pham" model="ir.actions.act_window">
            <field name="name">Phạt vi phạm</field>
            <field name="res_model">account.invoice</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_phat_vi_pham_tree"/>
            <field name="search_view_id" ref="view_phat_vi_pham_filter"/>
            <field name="domain">[('mlg_type','=','phat_vi_pham')]</field>
            <field name="context">{'default_mlg_type': 'phat_vi_pham', 'default_type': 'out_invoice'}</field>
        </record>
		<record id="action_phat_vi_pham1" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_phat_vi_pham_tree"/>
            <field name="act_window_id" ref="action_phat_vi_pham"/>
        </record>
        <record id="action_phat_vi_pham2" model="ir.actions.act_window.view">
            <field eval="2" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_phat_vi_pham_form"/>
            <field name="act_window_id" ref="action_phat_vi_pham"/>
        </record>
        

<!-- Thu nợ xưởng -->
		<record id="view_thu_no_xuong_filter" model="ir.ui.view">
            <field name="name">thu.no.xuong.select</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <search string="Thu nợ xưởng">
                	<field name="name" string="Mã phiếu đề xuất"/>
                	<field name="chinhanh_id" string="Chi nhánh"/>
                    <field name="date_invoice" string="Ngày giao dịch"/>
                    <field name="partner_id" string="Đối tượng"/>
                    <field name="account_id" string="Đội xe"/>
                    <field name="journal_id" string="Phương thức thanh toán"/>
                    <field name="state"/>
                    <group expand="0" string="Group By">
                    	<filter name="group_by_partner_id" string="Đối tượng" context="{'group_by':'partner_id'}"/>
                    	<filter name="group_by_date_invoice" string="Ngày giao dịch" context="{'group_by':'date_invoice'}"/>
                    	<filter name="group_by_account_id" string="Đội xe" context="{'group_by':'account_id'}"/>
                    	<filter name="group_by_journal_id" string="Phương thức thanh toán" context="{'group_by':'journal_id'}"/>
                    	<filter name="group_by_chinhanh_id" string="Chi nhánh" context="{'group_by':'chinhanh_id'}"/>
                    	<filter name="group_by_state" string="Trạng thái" context="{'group_by':'state'}"/>
                    </group>
               </search>
            </field>
        </record>
    	<record id="view_thu_no_xuong_tree" model="ir.ui.view">
            <field name="name">thu.no.xuong.tree</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <tree string="Thu nợ xưởng">
                	<field name="name" string="Mã phiếu đề xuất"/>
                	<field name="chinhanh_id" string="Chi nhánh"/>
                    <field name="date_invoice" string="Ngày giao dịch"/>
                    <field name="partner_id" string="Đối tượng"/>
                    <field name="account_id" string="Đội xe"/>
                    <field name="journal_id" string="Phương thức thanh toán"/>
                    <field name="so_hop_dong"/>
                    <field name="period_id" invisible='1'/>
                    <field name="currency_id" invisible='1'/>
                    <field name="amount_total" string="Tổng tiền" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="residual" string="Còn lại" groups="account.group_account_user" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="state"/>
                    <field name="mlg_type" invisible='1'/>
                    <field name="type" invisible='1'/>
                </tree>
            </field>
        </record>
        <record id="view_thu_no_xuong_form" model="ir.ui.view">
            <field name="name">thu.no.xuong.form</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <form string="Thu nợ xưởng" version='7.0'>
					<header>
	                    <button name="invoice_open" states="draft" string="Approve" class="oe_highlight" groups="base.group_user"/>
	                    <button name="invoice_open" states="proforma2" string="Approve" groups="base.group_user"/>
	                    <button name="invoice_pay_customer" type="object" string="Register Payment"
	                        attrs="{'invisible': [('state','!=','open')]}" class="oe_highlight" groups="base.group_user"/>
	                    <button name="invoice_cancel" states="draft,proforma2,open" string="Cancel Invoice" groups="base.group_no_one"/>
	                    <button name="action_cancel_draft" states="cancel" string="Reset to Draft" type="object" groups="base.group_user"/>
						<field name="state" widget="statusbar" statusbar_visible="draft,open,paid"/>
						<field name="mlg_type" invisible='1'/>
                    	<field name="type" invisible='1'/>
					</header>
                	<sheet>
                		<h1>
                			<label string='Mã phiếu đề xuất'/>
                			<field name="name" nolabel='1' class="oe_inline" readonly='1'/>
                		</h1>
	                    <group col="4" colspan="2">
	                    	<group>
		                    	<field name="chinhanh_id" string="Chi nhánh"/>
		                    	<field name="loai_doituong" string="Loại đối tượng" required='1' on_change="onchange_loaidoituong(loai_doituong)"/>
			                    <field name="partner_id" options="{'no_create': True}" domain="[('customer','=',True)]" string="Đối tượng" context="{'cong_no_thu':1,'loai_doituong':loai_doituong,'form_view_ref':loai_doituong=='taixe' and 'mlg_arap_account.view_tai_xe_form' or (loai_doituong=='nhanvienvanphong' and 'mlg_arap_account.view_nhanvienvanphong_form' or 'mlg_arap_account.view_nha_dau_tu_form')}" on_change="onchange_doituong(partner_id,loai_doituong)"/>
			                    <field name="chinhanh_ndt_id" invisible='1' context="{'cong_no_thu':1,'partner_id':partner_id}" domain="[('parent_id.code','=','1')]" on_change="onchange_chinhanh_ndt(chinhanh_ndt_id,partner_id)" attrs="{'invisible':[('loai_doituong','!=','nhadautu')],'required':[('loai_doituong','=','nhadautu')]}"/>
			                    <field name="journal_id" invisible='1' string="Phương thức thanh toán" widget ="selection" on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)"/>
		                    </group>
		                    <group>
			                    <field name="date_invoice" string="Ngày giao dịch" required='1'/>
			                    <field name="account_id" string="Đội xe" context="{'show_doixe':1,'cong_no_thu_nhadautu':1,'chinhanh_ndt_id':chinhanh_ndt_id,'partner_id':partner_id}" attrs="{'readonly':[('loai_doituong','=','taixe')],'invisible':[('loai_doituong','!=','taixe')]}"/>
			                    <field name="bai_giaoca_id" string="Bãi giao ca" attrs="{'invisible':[('loai_doituong','!=','taixe')]}"/>
			                    <field name="bien_so_xe"/>
			                    <field name="cmnd" attrs="{'invisible':[('loai_doituong','!=','nhadautu')]}"/>
			                    <field name="giayphep_kinhdoanh" attrs="{'invisible':[('loai_doituong','!=','nhadautu')]}"/>
			                    <field name="so_hop_dong"/>
	                    		<field name="ma_bang_chiettinh_chiphi_sua"/>
	                    		<field name="ma_xuong_id" options="{'no_create': True}"/>
		                    </group>
	                    </group>
                    	<group col="4" colspan="2">
	                    	<field name="so_tien" required='1' on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)" widget="monetary" options="{'currency_field': 'currency_id'}"/>
	                    	<newline/>
	                    	<field name="residual" string="Còn lại" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    	</group>
                    	<group>
                    		<field name="dien_giai" placeholder="Diễn giải ..." nolabel='1' on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)"/>
                    	</group>
	                    <notebook>
		                    <page string="Payments" groups="base.group_user">
	                            <field name="payment_ids">
	                                <tree string="Payments">
	                                    <field name="date" string="Ngày thanh toán"/>
	                                    <field name="move_id" string="Bút toán"/>
	                                    <field name="journal_id" groups="base.group_user" string="Phương thức thanh toán"/>
	                                    <field name="debit" string="Nợ"/>
	                                    <field name="credit" string="Có"/>
	                                    <field name="amount_currency" groups="base.group_multi_currency"/>
	                                    <field name="currency_id" groups="base.group_multi_currency"/>
	                                </tree>
	                            </field>
	                        </page>
	                        <page string="Chi tiết công nợ" invisible='1'>
			                    <field name="invoice_line" context="{'journal_id': journal_id}">
									<tree editable='bottom'>
										<field name="name" string="Diễn giải"/>
										<field name="account_id" invisible='0'/>
										<field name="price_unit" string="Số tiền"/>
									</tree>			                    
			                    </field>
			                    <field name="period_id" invisible='1'/>
			                    <field name="company_id" invisible='1'/>
			                    <field name="currency_id" invisible='1'/>
			                    <group class="oe_subtotal_footer oe_right">
	                                <field name="amount_total" string="Tổng tiền" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
	                            </group>
	                            <div class="oe_clear"/>
		                    </page>
	                    </notebook>
                    </sheet>
                    <div class="oe_chatter">
		                <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
		                <field name="message_ids" widget="mail_thread"/>
		            </div>
                </form>
            </field>
        </record>
        <record id="action_thu_no_xuong" model="ir.actions.act_window">
            <field name="name">Thu nợ xưởng</field>
            <field name="res_model">account.invoice</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_thu_no_xuong_tree"/>
            <field name="search_view_id" ref="view_thu_no_xuong_filter"/>
            <field name="domain">[('mlg_type','=','thu_no_xuong')]</field>
            <field name="context">{'default_mlg_type': 'thu_no_xuong', 'default_type': 'out_invoice'}</field>
        </record>
		<record id="action_thu_no_xuong1" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_thu_no_xuong_tree"/>
            <field name="act_window_id" ref="action_thu_no_xuong"/>
        </record>
        <record id="action_thu_no_xuong2" model="ir.actions.act_window.view">
            <field eval="2" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_thu_no_xuong_form"/>
            <field name="act_window_id" ref="action_thu_no_xuong"/>
        </record>

<!-- Thu phí thương hiệu -->
		<record id="view_thu_phi_thuong_hieu_filter" model="ir.ui.view">
            <field name="name">thu.phi.thuong.hieu.select</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <search string="Thu phí thương hiệu">
                	<field name="name" string="Mã phiếu đề xuất"/>
                	<field name="chinhanh_id" string="Chi nhánh"/>
                    <field name="date_invoice" string="Ngày giao dịch"/>
                    <field name="partner_id" string="Nhà đầu tư"/>
                    <field name="account_id" string="Đội kinh doanh"/>
                    <field name="journal_id" string="Phương thức thanh toán"/>
                    <field name="state"/>
                    <group expand="0" string="Group By">
                    	<filter name="group_by_partner_id" string="Nhà đầu tư" context="{'group_by':'partner_id'}"/>
                    	<filter name="group_by_date_invoice" string="Ngày giao dịch" context="{'group_by':'date_invoice'}"/>
                    	<filter name="group_by_account_id" string="Đội kinh doanh" context="{'group_by':'account_id'}"/>
                    	<filter name="group_by_journal_id" string="Phương thức thanh toán" context="{'group_by':'journal_id'}"/>
                    	<filter name="group_by_chinhanh_id" string="Chi nhánh" context="{'group_by':'chinhanh_id'}"/>
                    	<filter name="group_by_state" string="Trạng thái" context="{'group_by':'state'}"/>
                    </group>
               </search>
            </field>
        </record>
    	<record id="view_thu_phi_thuong_hieu_tree" model="ir.ui.view">
            <field name="name">thu.phi.thuong.hieu.tree</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <tree string="Thu phí thương hiệu">
                	<field name="name" string="Mã phiếu đề xuất"/>
                	<field name="chinhanh_id" string="Chi nhánh"/>
                    <field name="date_invoice" string="Ngày giao dịch"/>
                    <field name="partner_id" string="Nhà đầu tư"/>
                    <field name="account_id" string="Đội kinh doanh"/>
                    <field name="journal_id" string="Phương thức thanh toán"/>
                    <field name="so_hop_dong" string="Mã hợp đồng"/>
                    <field name="period_id" invisible='1'/>
                    <field name="currency_id" invisible='1'/>
                    <field name="amount_total" string="Tổng tiền" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="residual" string="Còn lại" groups="account.group_account_user" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="state"/>
                    <field name="mlg_type" invisible='1'/>
                    <field name="type" invisible='1'/>
                </tree>
            </field>
        </record>
        <record id="view_thu_phi_thuong_hieu_form" model="ir.ui.view">
            <field name="name">thu.phi.thuong.hieu.form</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <form string="Thu phí thương hiệu" version='7.0'>
					<header>
	                    <button name="invoice_open" states="draft" string="Approve" class="oe_highlight" groups="base.group_user"/>
	                    <button name="invoice_open" states="proforma2" string="Approve" groups="base.group_user"/>
	                    <button name="invoice_pay_customer" type="object" string="Register Payment"
	                        attrs="{'invisible': [('state','!=','open')]}" class="oe_highlight" groups="base.group_user"/>
	                    <button name="invoice_cancel" states="draft,proforma2,open" string="Cancel Invoice" groups="base.group_no_one"/>
	                    <button name="action_cancel_draft" states="cancel" string="Reset to Draft" type="object" groups="base.group_user"/>
						<field name="state" widget="statusbar" statusbar_visible="draft,open,paid"/>
						<field name="mlg_type" invisible='1'/>
                    	<field name="type" invisible='1'/>
					</header>
                	<sheet>
                		<h1>
                			<label string='Mã phiếu đề xuất'/>
                			<field name="name" nolabel='1' class="oe_inline" readonly='1'/>
                		</h1>
                		<group col="4" colspan="2">
	                    	<group>
		                    	<field name="chinhanh_id" string="Chi nhánh"/>
		                    	<field name="loai_doituong" string="Loại đối tượng" required='1' on_change="onchange_loaidoituong(loai_doituong)"/>
			                    <field name="partner_id" options="{'no_create': True}" domain="[('customer','=',True)]" string="Đối tượng" context="{'cong_no_thu':1,'loai_doituong':loai_doituong,'form_view_ref':loai_doituong=='taixe' and 'mlg_arap_account.view_tai_xe_form' or (loai_doituong=='nhanvienvanphong' and 'mlg_arap_account.view_nhanvienvanphong_form' or 'mlg_arap_account.view_nha_dau_tu_form')}" on_change="onchange_doituong(partner_id,loai_doituong)"/>
			                    <field name="chinhanh_ndt_id" invisible='1' context="{'cong_no_thu':1,'partner_id':partner_id}" domain="[('parent_id.code','=','1')]" on_change="onchange_chinhanh_ndt(chinhanh_ndt_id,partner_id)" attrs="{'invisible':[('loai_doituong','!=','nhadautu')],'required':[('loai_doituong','=','nhadautu')]}"/>
			                    <field name="journal_id" invisible='1' string="Phương thức thanh toán" widget ="selection" on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)"/>
		                    </group>
		                    <group>
			                    <field name="date_invoice" string="Ngày giao dịch" required='1'/>
			                    <field name="account_id" string="Đội xe" context="{'show_doixe':1,'cong_no_thu_nhadautu':1,'chinhanh_ndt_id':chinhanh_ndt_id,'partner_id':partner_id}" attrs="{'readonly':[('loai_doituong','=','taixe')],'invisible':[('loai_doituong','!=','taixe')]}"/>
			                    <field name="bai_giaoca_id" string="Bãi giao ca" attrs="{'invisible':[('loai_doituong','!=','taixe')]}"/>
			                    <field name="bien_so_xe"/>
			                    <field name="cmnd" attrs="{'invisible':[('loai_doituong','!=','nhadautu')]}"/>
			                    <field name="giayphep_kinhdoanh" attrs="{'invisible':[('loai_doituong','!=','nhadautu')]}"/>
			                    <field name="so_hop_dong"/>
		                    </group>
	                    </group>
                    	<group col="4" colspan="2">
	                    	<field name="so_tien" required='1' on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)" widget="monetary" options="{'currency_field': 'currency_id'}"/>
	                    	<newline/>
	                    	<field name="residual" string="Còn lại" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    	</group>
                    	<group>
                    		<field name="dien_giai" placeholder="Diễn giải ..." nolabel='1' on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)"/>
                    	</group>
	                    <notebook>
		                    <page string="Payments" groups="base.group_user">
	                            <field name="payment_ids">
	                                <tree string="Payments">
	                                    <field name="date" string="Ngày thanh toán"/>
	                                    <field name="move_id" string="Bút toán"/>
	                                    <field name="journal_id" groups="base.group_user" string="Phương thức thanh toán"/>
	                                    <field name="debit" string="Nợ"/>
	                                    <field name="credit" string="Có"/>
	                                    <field name="amount_currency" groups="base.group_multi_currency"/>
	                                    <field name="currency_id" groups="base.group_multi_currency"/>
	                                </tree>
	                            </field>
	                        </page>
	                        <page string="Chi tiết công nợ" invisible='1'>
			                    <field name="invoice_line" context="{'journal_id': journal_id}">
									<tree editable='bottom'>
										<field name="name" string="Diễn giải"/>
										<field name="account_id" invisible='0'/>
										<field name="price_unit" string="Số tiền"/>
									</tree>			                    
			                    </field>
			                    <field name="period_id" invisible='1'/>
			                    <field name="company_id" invisible='1'/>
			                    <field name="currency_id" invisible='1'/>
			                    <group class="oe_subtotal_footer oe_right">
	                                <field name="amount_total" string="Tổng tiền" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
	                            </group>
	                            <div class="oe_clear"/>
		                    </page>
	                    </notebook>
                    </sheet>
                    <div class="oe_chatter">
		                <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
		                <field name="message_ids" widget="mail_thread"/>
		            </div>
                </form>
            </field>
        </record>
        <record id="action_thu_phi_thuong_hieu" model="ir.actions.act_window">
            <field name="name">Thu phí thương hiệu</field>
            <field name="res_model">account.invoice</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_thu_phi_thuong_hieu_tree"/>
            <field name="search_view_id" ref="view_thu_phi_thuong_hieu_filter"/>
            <field name="domain">[('mlg_type','=','thu_phi_thuong_hieu')]</field>
            <field name="context">{'default_mlg_type': 'thu_phi_thuong_hieu', 'default_type': 'out_invoice'}</field>
        </record>
		<record id="action_thu_phi_thuong_hieu1" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_thu_phi_thuong_hieu_tree"/>
            <field name="act_window_id" ref="action_thu_phi_thuong_hieu"/>
        </record>
        <record id="action_thu_phi_thuong_hieu2" model="ir.actions.act_window.view">
            <field eval="2" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_thu_phi_thuong_hieu_form"/>
            <field name="act_window_id" ref="action_thu_phi_thuong_hieu"/>
        </record>
        
<!-- Trả góp xe -->
		<record id="view_tra_gop_xe_filter" model="ir.ui.view">
            <field name="name">tra.gop.xe.select</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <search string="Trả góp xe">
                	<field name="name" string="Mã phiếu đề xuất"/>
                	<field name="chinhanh_id" string="Chi nhánh"/>
                    <field name="date_invoice" string="Ngày giao dịch"/>
                    <field name="partner_id" string="Nhà đầu tư"/>
                    <field name="account_id" string="Đội kinh doanh"/>
                    <field name="journal_id" string="Phương thức thanh toán"/>
                    <field name="state"/>
                    <group expand="0" string="Group By">
                    	<filter name="group_by_partner_id" string="Nhà đầu tư" context="{'group_by':'partner_id'}"/>
                    	<filter name="group_by_date_invoice" string="Ngày giao dịch" context="{'group_by':'date_invoice'}"/>
                    	<filter name="group_by_account_id" string="Đội kinh doanh" context="{'group_by':'account_id'}"/>
                    	<filter name="group_by_journal_id" string="Phương thức thanh toán" context="{'group_by':'journal_id'}"/>
                    	<filter name="group_by_chinhanh_id" string="Chi nhánh" context="{'group_by':'chinhanh_id'}"/>
                    	<filter name="group_by_state" string="Trạng thái" context="{'group_by':'state'}"/>
                    </group>
               </search>
            </field>
        </record>
    	<record id="view_tra_gop_xe_tree" model="ir.ui.view">
            <field name="name">tra.gop.xe.tree</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <tree string="Trả góp xe">
                	<field name="name" string="Mã phiếu đề xuất"/>
                	<field name="chinhanh_id" string="Chi nhánh"/>
                    <field name="date_invoice" string="Ngày giao dịch"/>
                    <field name="partner_id" string="Nhà đầu tư"/>
                    <field name="account_id" string="Đội kinh doanh"/>
                    <field name="journal_id" string="Phương thức thanh toán"/>
                    <field name="so_hop_dong" string="Mã hợp đồng"/>
                    <field name="period_id" invisible='1'/>
                    <field name="currency_id" invisible='1'/>
                    <field name="amount_total" string="Tổng tiền" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="residual" string="Còn lại" groups="account.group_account_user" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="state"/>
                    <field name="mlg_type" invisible='1'/>
                    <field name="type" invisible='1'/>
                </tree>
            </field>
        </record>
        <record id="view_tra_gop_xe_form" model="ir.ui.view">
            <field name="name">tra.gop.xe.form</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <form string="Trả góp xe" version='7.0'>
					<header>
	                    <button name="invoice_open" states="draft" string="Approve" class="oe_highlight" groups="base.group_user"/>
	                    <button name="invoice_open" states="proforma2" string="Approve" groups="base.group_user"/>
	                    <button name="invoice_pay_customer" type="object" string="Register Payment"
	                        attrs="{'invisible': [('state','!=','open')]}" class="oe_highlight" groups="base.group_user"/>
	                    <button name="invoice_cancel" states="draft,proforma2,open" string="Cancel Invoice" groups="base.group_no_one"/>
	                    <button name="action_cancel_draft" states="cancel" string="Reset to Draft" type="object" groups="base.group_user"/>
						<field name="state" widget="statusbar" statusbar_visible="draft,open,paid"/>
						<field name="mlg_type" invisible='1'/>
                    	<field name="type" invisible='1'/>
					</header>
                	<sheet>
                		<h1>
                			<label string='Mã phiếu đề xuất'/>
                			<field name="name" nolabel='1' class="oe_inline" readonly='1'/>
                		</h1>
                		<group col="4" colspan="2">
	                    	<group>
		                    	<field name="chinhanh_id" string="Chi nhánh"/>
		                    	<field name="loai_doituong" string="Loại đối tượng" required='1' on_change="onchange_loaidoituong(loai_doituong)"/>
			                    <field name="partner_id" options="{'no_create': True}" domain="[('customer','=',True)]" string="Đối tượng" context="{'cong_no_thu':1,'loai_doituong':loai_doituong,'form_view_ref':loai_doituong=='taixe' and 'mlg_arap_account.view_tai_xe_form' or (loai_doituong=='nhanvienvanphong' and 'mlg_arap_account.view_nhanvienvanphong_form' or 'mlg_arap_account.view_nha_dau_tu_form')}" on_change="onchange_doituong(partner_id,loai_doituong)"/>
			                    <field name="chinhanh_ndt_id" invisible='1' context="{'cong_no_thu':1,'partner_id':partner_id}" domain="[('parent_id.code','=','1')]" on_change="onchange_chinhanh_ndt(chinhanh_ndt_id,partner_id)" attrs="{'invisible':[('loai_doituong','!=','nhadautu')],'required':[('loai_doituong','=','nhadautu')]}"/>
			                    <field name="journal_id" invisible='1' string="Phương thức thanh toán" widget ="selection" on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)"/>
		                    </group>
		                    <group>
			                    <field name="date_invoice" string="Ngày giao dịch" required='1'/>
			                    <field name="account_id" string="Đội xe" context="{'show_doixe':1,'cong_no_thu_nhadautu':1,'chinhanh_ndt_id':chinhanh_ndt_id,'partner_id':partner_id}" attrs="{'readonly':[('loai_doituong','=','taixe')],'invisible':[('loai_doituong','!=','taixe')]}"/>
			                    <field name="bai_giaoca_id" string="Bãi giao ca" attrs="{'invisible':[('loai_doituong','!=','taixe')]}"/>
			                    <field name="bien_so_xe"/>
			                    <field name="cmnd" attrs="{'invisible':[('loai_doituong','!=','nhadautu')]}"/>
			                    <field name="giayphep_kinhdoanh" attrs="{'invisible':[('loai_doituong','!=','nhadautu')]}"/>
			                    <field name="so_hop_dong"/>
		                    </group>
	                    </group>
                    	<group col="4" colspan="2">
	                    	<field name="so_tien" required='1' on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)" widget="monetary" options="{'currency_field': 'currency_id'}"/>
	                    	<newline/>
	                    	<field name="residual" string="Còn lại" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    	</group>
                    	<group>
                    		<field name="dien_giai" placeholder="Diễn giải ..." nolabel='1' on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)"/>
                    	</group>
	                    <notebook>
		                    <page string="Payments" groups="base.group_user">
	                            <field name="payment_ids">
	                                <tree string="Payments">
	                                    <field name="date" string="Ngày thanh toán"/>
	                                    <field name="move_id" string="Bút toán"/>
	                                    <field name="journal_id" groups="base.group_user" string="Phương thức thanh toán"/>
	                                    <field name="debit" string="Nợ"/>
	                                    <field name="credit" string="Có"/>
	                                    <field name="amount_currency" groups="base.group_multi_currency"/>
	                                    <field name="currency_id" groups="base.group_multi_currency"/>
	                                </tree>
	                            </field>
	                        </page>
	                        <page string="Chi tiết công nợ" invisible='1'>
			                    <field name="invoice_line" context="{'journal_id': journal_id}">
									<tree editable='bottom'>
										<field name="name" string="Diễn giải"/>
										<field name="account_id" invisible='0'/>
										<field name="price_unit" string="Số tiền"/>
									</tree>			                    
			                    </field>
			                    <field name="period_id" invisible='1'/>
			                    <field name="company_id" invisible='1'/>
			                    <field name="currency_id" invisible='1'/>
			                    <group class="oe_subtotal_footer oe_right">
	                                <field name="amount_total" string="Tổng tiền" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
	                            </group>
	                            <div class="oe_clear"/>
		                    </page>
	                    </notebook>
                    </sheet>
                    <div class="oe_chatter">
		                <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
		                <field name="message_ids" widget="mail_thread"/>
		            </div>
                </form>
            </field>
        </record>
        <record id="action_tra_gop_xe" model="ir.actions.act_window">
            <field name="name">Trả góp xe</field>
            <field name="res_model">account.invoice</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_tra_gop_xe_tree"/>
            <field name="search_view_id" ref="view_tra_gop_xe_filter"/>
            <field name="domain">[('mlg_type','=','tra_gop_xe')]</field>
            <field name="context">{'default_mlg_type': 'tra_gop_xe', 'default_type': 'out_invoice'}</field>
        </record>
		<record id="action_tra_gop_xe1" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_tra_gop_xe_tree"/>
            <field name="act_window_id" ref="action_tra_gop_xe"/>
        </record>
        <record id="action_tra_gop_xe2" model="ir.actions.act_window.view">
            <field eval="2" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_tra_gop_xe_form"/>
            <field name="act_window_id" ref="action_tra_gop_xe"/>
        </record>
        
<!-- Hoàn tạm ứng -->
		<record id="view_hoan_tam_ung_filter" model="ir.ui.view">
            <field name="name">hoan.tam.ung.select</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <search string="Hoàn tạm ứng">
                	<field name="name" string="Mã phiếu đề xuất"/>
                	<field name="chinhanh_id" string="Chi nhánh"/>
                    <field name="date_invoice" string="Ngày giao dịch"/>
                    <field name="partner_id" string="Đối tượng"/>
                    <field name="account_id" string="Phòng ban/Đội xe"/>
                    <field name="journal_id" string="Phương thức thanh toán"/>
                    <field name="state"/>
                    <group expand="0" string="Group By">
                    	<filter name="group_by_partner_id" string="Đối tượng" context="{'group_by':'partner_id'}"/>
                    	<filter name="group_by_date_invoice" string="Ngày giao dịch" context="{'group_by':'date_invoice'}"/>
                    	<filter name="group_by_account_id" string="Phòng ban/Đội xe" context="{'group_by':'account_id'}"/>
                    	<filter name="group_by_journal_id" string="Phương thức thanh toán" context="{'group_by':'journal_id'}"/>
                    	<filter name="group_by_chinhanh_id" string="Chi nhánh" context="{'group_by':'chinhanh_id'}"/>
                    	<filter name="group_by_state" string="Trạng thái" context="{'group_by':'state'}"/>
                    </group>
               </search>
            </field>
        </record>
    	<record id="view_hoan_tam_ung_tree" model="ir.ui.view">
            <field name="name">hoan.tam.ung.tree</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <tree string="Hoàn tạm ứng">
                	<field name="name" string="Mã phiếu đề xuất"/>
                	<field name="chinhanh_id" string="Chi nhánh"/>
                    <field name="date_invoice" string="Ngày giao dịch"/>
                    <field name="partner_id" string="Đối tượng"/>
                    <field name="account_id" string="Phòng ban/Đội xe"/>
                    <field name="journal_id" string="Phương thức thanh toán"/>
                    <field name="so_hop_dong" string="Mã hợp đồng"/>
                    <field name="period_id" invisible='1'/>
                    <field name="currency_id" invisible='1'/>
                    <field name="amount_total" string="Tổng tiền" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="residual" string="Còn lại" groups="account.group_account_user" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="state"/>
                    <field name="mlg_type" invisible='1'/>
                    <field name="type" invisible='1'/>
                </tree>
            </field>
        </record>
        <record id="view_hoan_tam_ung_form" model="ir.ui.view">
            <field name="name">hoan.tam.ung.form</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <form string="Hoàn tạm ứng" version='7.0'>
					<header>
	                    <button name="invoice_open" states="draft" string="Approve" class="oe_highlight" groups="base.group_user"/>
	                    <button name="invoice_open" states="proforma2" string="Approve" groups="base.group_user"/>
	                    <button name="invoice_pay_customer" type="object" string="Register Payment"
	                        attrs="{'invisible': [('state','!=','open')]}" class="oe_highlight" groups="base.group_user"/>
	                    <button name="invoice_cancel" states="draft,proforma2,open" string="Cancel Invoice" groups="base.group_no_one"/>
	                    <button name="action_cancel_draft" states="cancel" string="Reset to Draft" type="object" groups="base.group_user"/>
						<field name="state" widget="statusbar" statusbar_visible="draft,open,paid"/>
						<field name="mlg_type" invisible='1'/>
                    	<field name="type" invisible='1'/>
					</header>
                	<sheet>
                		<h1>
                			<label string='Mã phiếu đề xuất'/>
                			<field name="name" nolabel='1' class="oe_inline" readonly='1'/>
                		</h1>
                		<group col="4" colspan="2">
	                    	<group>
		                    	<field name="chinhanh_id" string="Chi nhánh"/>
		                    	<field name="loai_doituong" string="Loại đối tượng" required='1' on_change="onchange_loaidoituong(loai_doituong)"/>
			                    <field name="partner_id" options="{'no_create': True}" domain="[('customer','=',True)]" string="Đối tượng" context="{'cong_no_thu':1,'loai_doituong':loai_doituong,'form_view_ref':loai_doituong=='taixe' and 'mlg_arap_account.view_tai_xe_form' or (loai_doituong=='nhanvienvanphong' and 'mlg_arap_account.view_nhanvienvanphong_form' or 'mlg_arap_account.view_nha_dau_tu_form')}" on_change="onchange_doituong(partner_id,loai_doituong)"/>
			                    <field name="chinhanh_ndt_id" invisible='1' context="{'cong_no_thu':1,'partner_id':partner_id}" domain="[('parent_id.code','=','1')]" on_change="onchange_chinhanh_ndt(chinhanh_ndt_id,partner_id)" attrs="{'invisible':[('loai_doituong','!=','nhadautu')],'required':[('loai_doituong','=','nhadautu')]}"/>
			                    <field name="journal_id" invisible='1' string="Phương thức thanh toán" widget ="selection" on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)"/>
			                    <field name="chung_tu_bao_hiem"/>
			                    <field name="so_tien_tren_ct"/>
		                    </group>
		                    <group>
			                    <field name="date_invoice" string="Ngày giao dịch" required='1'/>
			                    <field name="account_id" string="Đội xe" context="{'show_doixe':1,'cong_no_thu_nhadautu':1,'chinhanh_ndt_id':chinhanh_ndt_id,'partner_id':partner_id}" attrs="{'readonly':[('loai_doituong','=','taixe')],'invisible':[('loai_doituong','!=','taixe')]}"/>
			                    <field name="bai_giaoca_id" string="Bãi giao ca" attrs="{'invisible':[('loai_doituong','!=','taixe')]}"/>
			                    <field name="bien_so_xe"/>
			                    <field name="cmnd" attrs="{'invisible':[('loai_doituong','!=','nhadautu')]}"/>
			                    <field name="giayphep_kinhdoanh" attrs="{'invisible':[('loai_doituong','!=','nhadautu')]}"/>
			                    <field name="so_hoa_don"/>
			                    <field name="so_tien_tren_hd"/>
			                    <field name="loai_tamung_id" options="{'no_create': True}"/>
		                    </group>
	                    </group>
                    	<group col="4" colspan="2">
	                    	<field name="so_tien" required='1' on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)" widget="monetary" options="{'currency_field': 'currency_id'}"/>
	                    	<newline/>
	                    	<field name="residual" string="Còn lại" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    	</group>
                    	<group>
                    		<field name="dien_giai" placeholder="Diễn giải ..." nolabel='1' on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)"/>
                    	</group>
	                    <notebook>
		                    <page string="Payments" groups="base.group_user">
	                            <field name="payment_ids">
	                                <tree string="Payments">
	                                    <field name="date" string="Ngày thanh toán"/>
	                                    <field name="move_id" string="Bút toán"/>
	                                    <field name="journal_id" groups="base.group_user" string="Phương thức thanh toán"/>
	                                    <field name="debit" string="Nợ"/>
	                                    <field name="credit" string="Có"/>
	                                    <field name="amount_currency" groups="base.group_multi_currency"/>
	                                    <field name="currency_id" groups="base.group_multi_currency"/>
	                                </tree>
	                            </field>
	                        </page>
	                        <page string="Chi tiết công nợ" invisible='1'>
			                    <field name="invoice_line" context="{'journal_id': journal_id}">
									<tree editable='bottom'>
										<field name="name" string="Diễn giải"/>
										<field name="account_id" invisible='0'/>
										<field name="price_unit" string="Số tiền"/>
									</tree>			                    
			                    </field>
			                    <field name="period_id" invisible='1'/>
			                    <field name="company_id" invisible='1'/>
			                    <field name="currency_id" invisible='1'/>
			                    <group class="oe_subtotal_footer oe_right">
	                                <field name="amount_total" string="Tổng tiền" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
	                            </group>
	                            <div class="oe_clear"/>
		                    </page>
	                    </notebook>
                    </sheet>
                    <div class="oe_chatter">
		                <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
		                <field name="message_ids" widget="mail_thread"/>
		            </div>
                </form>
            </field>
        </record>
        <record id="action_hoan_tam_ung" model="ir.actions.act_window">
            <field name="name">Hoàn tạm ứng</field>
            <field name="res_model">account.invoice</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_hoan_tam_ung_tree"/>
            <field name="search_view_id" ref="view_hoan_tam_ung_filter"/>
            <field name="domain">[('mlg_type','=','hoan_tam_ung')]</field>
            <field name="context">{'default_mlg_type': 'hoan_tam_ung', 'default_type': 'out_invoice'}</field>
        </record>
		<record id="action_hoan_tam_ung1" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_hoan_tam_ung_tree"/>
            <field name="act_window_id" ref="action_hoan_tam_ung"/>
        </record>
        <record id="action_hoan_tam_ung2" model="ir.actions.act_window.view">
            <field eval="2" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_hoan_tam_ung_form"/>
            <field name="act_window_id" ref="action_hoan_tam_ung"/>
        </record>

<!-- Chi nợ doanh thu -->
		<record id="view_chi_no_doanh_thu_filter" model="ir.ui.view">
            <field name="name">chi.no.doanh.thu.select</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <search string="Chi nợ doanh thu">
                	<field name="name" string="Mã phiếu đề xuất"/>
                    <field name="date_invoice" string="Ngày giao dịch"/>
                    <field name="partner_id" string="Đối tượng"/>
                    <field name="account_id" string="Đội xe"/>
                    <field name="bai_giaoca_id" string="Bãi giao ca"/>
                    <field name="journal_id" string="Phương thức thanh toán"/>
                    <field name="chinhanh_id" string="Chi nhánh"/>
                    <field name="state"/>
                    <group expand="0" string="Group By">
                    	<filter name="group_by_partner_id" string="Đối tượng" context="{'group_by':'partner_id'}"/>
                    	<filter name="group_by_date_invoice" string="Ngày giao dịch" context="{'group_by':'date_invoice'}"/>
                    	<filter name="group_by_account_id" string="Đội xe" context="{'group_by':'account_id'}"/>
                    	<filter name="group_by_bai_giaoca_id" string="Bãi giao ca" context="{'group_by':'bai_giaoca_id'}"/>
                    	<filter name="group_by_journal_id" string="Phương thức thanh toán" context="{'group_by':'journal_id'}"/>
                    	<filter name="group_by_chinhanh_id" string="Chi nhánh" context="{'group_by':'chinhanh_id'}"/>
                    	<filter name="group_by_state" string="Trạng thái" context="{'group_by':'state'}"/>
                    </group>
               </search>
            </field>
        </record>
    	<record id="view_chi_no_doanh_thu_tree" model="ir.ui.view">
            <field name="name">chi.no.doanh.thu.tree</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <tree string="Chi nợ doanh thu">
                	<field name="name" string="Mã phiếu đề xuất"/>
                    <field name="chinhanh_id" string="Chi nhánh"/>
                    <field name="date_invoice" string="Ngày giao dịch"/>
                    <field name="partner_id" string="Đối tượng"/>
                    <field name="account_id" string="Đội xe"/>
                    <field name="bai_giaoca_id" string="Bãi giao ca"/>
                    <field name="journal_id" string="Phương thức thanh toán"/>
                    <field name="period_id" invisible='1'/>
                    <field name="currency_id" invisible='1'/>
                    <field name="amount_total" string="Tổng tiền" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="residual" string="Còn lại" groups="account.group_account_user" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="mlg_type" invisible='1'/>
                    <field name="type" invisible='1'/>
                    <field name="state"/>
                </tree>
            </field>
        </record>
        <record id="view_chi_no_doanh_thu_form" model="ir.ui.view">
            <field name="name">chi.no.doanh.thu.form</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <form string="Chi nợ doanh thu" version='7.0'>
					<header>
	                    <button name="in_phieu" type="object" string="In" class="oe_highlight" context="{'name_report':'form_chi_no_doanh_thu_report'}"/>
	                    <button name="invoice_open" states="draft" string="Approve" class="oe_highlight" groups="base.group_user"/>
	                    <button name="invoice_open" states="proforma2" string="Approve" groups="base.group_user"/>
	                    <button name="invoice_pay_customer" type="object" string="Register Payment"
	                        attrs="{'invisible': [('state','!=','open')]}" class="oe_highlight" groups="base.group_user"/>
	                    <button name="invoice_cancel" states="draft,proforma2,open" string="Cancel Invoice" groups="base.group_no_one"/>
	                    <button name="action_cancel_draft" states="cancel" string="Reset to Draft" type="object" groups="base.group_user"/>
						<field name="state" widget="statusbar" statusbar_visible="draft,open,paid"/>
						<field name="mlg_type" invisible='1'/>
                    	<field name="type" invisible='1'/>
					</header>
                	<sheet>
                		<h1>
                			<label string='Mã phiếu đề xuất'/>
                			<field name="name" nolabel='1' class="oe_inline" readonly='1'/>
                		</h1>
	                    <group col="4" colspan="2">
	                    	<group>
		                    	<field name="chinhanh_id" string="Chi nhánh"/>
		                    	<field name="loai_doituong" string="Loại đối tượng" required='1' on_change="onchange_loaidoituong(loai_doituong)"/>
			                    <field name="partner_id" options="{'no_create': True}" domain="[('customer','=',True)]" string="Đối tượng" context="{'cong_no_thu':1,'loai_doituong':loai_doituong,'form_view_ref':loai_doituong=='taixe' and 'mlg_arap_account.view_tai_xe_form' or (loai_doituong=='nhanvienvanphong' and 'mlg_arap_account.view_nhanvienvanphong_form' or 'mlg_arap_account.view_nha_dau_tu_form')}" on_change="onchange_doituong(partner_id,loai_doituong)"/>
			                    <field name="chinhanh_ndt_id" invisible='1' context="{'cong_no_thu':1,'partner_id':partner_id}" domain="[('parent_id.code','=','1')]" on_change="onchange_chinhanh_ndt(chinhanh_ndt_id,partner_id)" attrs="{'invisible':[('loai_doituong','!=','nhadautu')],'required':[('loai_doituong','=','nhadautu')]}"/>
			                    <field name="journal_id" invisible='1' string="Phương thức thanh toán" widget ="selection" on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)"/>
		                    </group>
		                    <group>
			                    <field name="date_invoice" string="Ngày giao dịch" required='1'/>
			                    <field name="account_id" string="Đội xe" context="{'show_doixe':1,'cong_no_thu_nhadautu':1,'chinhanh_ndt_id':chinhanh_ndt_id,'partner_id':partner_id}" attrs="{'readonly':[('loai_doituong','=','taixe')],'invisible':[('loai_doituong','!=','taixe')]}"/>
			                    <field name="bai_giaoca_id" string="Bãi giao ca" attrs="{'invisible':[('loai_doituong','!=','taixe')]}"/>
			                    <field name="cmnd" attrs="{'invisible':[('loai_doituong','!=','nhadautu')]}"/>
			                    <field name="giayphep_kinhdoanh" attrs="{'invisible':[('loai_doituong','!=','nhadautu')]}"/>
		                    </group>
	                    </group>
                    	<group col="4" colspan="2">
	                    	<field name="so_tien" required='1' on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)" widget="monetary" options="{'currency_field': 'currency_id'}"/>
	                    	<newline/>
	                    	<field name="residual" string="Còn lại" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    	</group>
                    	<group>
                    		<field name="dien_giai" placeholder="Diễn giải ..." nolabel='1' on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)"/>
                    	</group>
	                    <notebook>
		                    <page string="Payments" groups="base.group_user">
	                            <field name="payment_ids">
	                                <tree string="Payments">
	                                    <field name="date" string="Ngày thanh toán"/>
	                                    <field name="move_id" string="Bút toán"/>
	                                    <field name="journal_id" groups="base.group_user" string="Phương thức thanh toán"/>
	                                    <field name="debit" string="Nợ"/>
	                                    <field name="credit" string="Có"/>
	                                    <field name="amount_currency" groups="base.group_multi_currency"/>
	                                    <field name="currency_id" groups="base.group_multi_currency"/>
	                                </tree>
	                            </field>
	                        </page>
	                        <page string="Chi tiết công nợ" invisible='1'>
			                    <field name="invoice_line" context="{'journal_id': journal_id}">
									<tree editable='bottom'>
										<field name="name" string="Diễn giải"/>
										<field name="account_id" invisible='0'/>
										<field name="price_unit" string="Số tiền"/>
									</tree>			                    
			                    </field>
			                    <field name="period_id" invisible='1'/>
			                    <field name="company_id" invisible='1'/>
			                    <field name="currency_id" invisible='1'/>
			                    <group class="oe_subtotal_footer oe_right">
	                                <field name="amount_total" string="Tổng tiền" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
	                            </group>
	                            <div class="oe_clear"/>
		                    </page>
	                    </notebook>
                    </sheet>
                    <div class="oe_chatter">
		                <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
		                <field name="message_ids" widget="mail_thread"/>
		            </div>
                </form>
            </field>
        </record>
        <record id="action_chi_no_doanh_thu" model="ir.actions.act_window">
            <field name="name">Chi nợ doanh thu</field>
            <field name="res_model">account.invoice</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_chi_no_doanh_thu_tree"/>
            <field name="search_view_id" ref="view_chi_no_doanh_thu_filter"/>
            <field name="domain">[('mlg_type','=','chi_no_doanh_thu')]</field>
            <field name="context">{'default_mlg_type': 'chi_no_doanh_thu', 'default_type': 'in_invoice'}</field>
        </record>
		<record id="action_chi_no_doanh_thu1" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_chi_no_doanh_thu_tree"/>
            <field name="act_window_id" ref="action_chi_no_doanh_thu"/>
        </record>
        <record id="action_chi_no_doanh_thu2" model="ir.actions.act_window.view">
            <field eval="2" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_chi_no_doanh_thu_form"/>
            <field name="act_window_id" ref="action_chi_no_doanh_thu"/>
        </record>
        
<!-- Chi điện thoại -->
		<record id="view_chi_dien_thoai_filter" model="ir.ui.view">
            <field name="name">chi.dien.thoai.select</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <search string="Search Invoice">
                	<field name="name" string="Mã phiếu đề xuất"/>
                    <field name="date_invoice" string="Ngày giao dịch"/>
                    <field name="partner_id" string="Đối tượng"/>
                    <field name="account_id" string="Đội xe"/>
                    <field name="chinhanh_id" string="Chi nhánh"/>
                    <field name="journal_id" string="Loại giao dịch"/>
                    <field name="state"/>
                    <group expand="0" string="Group By">
                    	<filter name="group_by_partner_id" string="Đối tượng" context="{'group_by':'partner_id'}"/>
                    	<filter name="group_by_date_invoice" string="Ngày giao dịch" context="{'group_by':'date_invoice'}"/>
                    	<filter name="group_by_account_id" string="Đội xe" context="{'group_by':'account_id'}"/>
                    	<filter name="group_by_bai_giaoca_id" string="Bãi giao ca" context="{'group_by':'bai_giaoca_id'}"/>
                    	<filter name="group_by_journal_id" string="Loại giao dịch" context="{'group_by':'journal_id'}"/>
                    	<filter name="group_by_chinhanh_id" string="Chi nhánh" context="{'group_by':'chinhanh_id'}"/>
                    	<filter name="group_by_state" string="Trạng thái" context="{'group_by':'state'}"/>
                    </group>
               </search>
            </field>
        </record>
    	<record id="view_chi_dien_thoai_tree" model="ir.ui.view">
            <field name="name">chi.dien.thoai.tree</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <tree string="Chi điện thoại">
                	<field name="name" string="Mã phiếu đề xuất"/>
                	<field name="chinhanh_id" string="Chi nhánh"/>
                    <field name="date_invoice" string="Ngày giao dịch"/>
                    <field name="partner_id" string="Đối tượng"/>
                    <field name="account_id" string="Tên Phòng ban/Đội xe"/>
                    <field name="so_hoa_don" string="Số hóa đơn" />
                    <field name="journal_id" string="Loại giao dịch"/>
                    <field name="mlg_type" invisible='1'/>
                    <field name="period_id" invisible='1'/>
                    <field name="currency_id" invisible='1'/>
                    <field name="amount_total" string="Tổng tiền" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="residual" string="Còn lại" groups="account.group_account_user" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="type" invisible='1'/>
                    <field name="state"/>
                </tree>
            </field>
        </record>
        <record id="view_chi_dien_thoai_form" model="ir.ui.view">
            <field name="name">chi.dien.thoai.form</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <form string="Chi điện thoại" version='7.0'>
					<header>
	                    <button name="invoice_open" states="draft" string="Approve" class="oe_highlight" groups="base.group_user"/>
	                    <button name="invoice_open" states="proforma2" string="Approve" groups="base.group_user"/>
	                    <button name="invoice_pay_customer" type="object" string="Register Payment"
	                        attrs="{'invisible': [('state','!=','open')]}" class="oe_highlight" groups="base.group_user"/>
	                    <button name="invoice_cancel" states="draft,proforma2,open" string="Cancel Invoice" groups="base.group_no_one"/>
	                    <button name="action_cancel_draft" states="cancel" string="Reset to Draft" type="object" groups="base.group_user"/>
						<field name="state" widget="statusbar" statusbar_visible="draft,open,paid"/>
						<field name="mlg_type" invisible='1'/>
                    	<field name="type" invisible='1'/>
					</header>
                	<sheet>
                		<h1>
                			<label string='Mã phiếu đề xuất'/>
                			<field name="name" nolabel='1' class="oe_inline" readonly='1'/>
                		</h1>
                		<group col="4" colspan="2">
	                    	<group>
		                    	<field name="chinhanh_id" string="Chi nhánh"/>
		                    	<field name="loai_doituong" string="Loại đối tượng" required='1' on_change="onchange_loaidoituong(loai_doituong)"/>
			                    <field name="partner_id" options="{'no_create': True}" domain="[('customer','=',True)]" string="Đối tượng" context="{'cong_no_thu':1,'loai_doituong':loai_doituong,'form_view_ref':loai_doituong=='taixe' and 'mlg_arap_account.view_tai_xe_form' or (loai_doituong=='nhanvienvanphong' and 'mlg_arap_account.view_nhanvienvanphong_form' or 'mlg_arap_account.view_nha_dau_tu_form')}" on_change="onchange_doituong(partner_id,loai_doituong)"/>
			                    <field name="chinhanh_ndt_id" invisible='1' context="{'cong_no_thu':1,'partner_id':partner_id}" domain="[('parent_id.code','=','1')]" on_change="onchange_chinhanh_ndt(chinhanh_ndt_id,partner_id)" attrs="{'invisible':[('loai_doituong','!=','nhadautu')],'required':[('loai_doituong','=','nhadautu')]}"/>
			                    <field name="journal_id" invisible='1' string="Phương thức thanh toán" widget ="selection" on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)"/>
		                    </group>
		                    <group>
			                    <field name="date_invoice" string="Ngày giao dịch" required='1'/>
			                    <field name="account_id" string="Đội xe" context="{'show_doixe':1,'cong_no_thu_nhadautu':1,'chinhanh_ndt_id':chinhanh_ndt_id,'partner_id':partner_id}" attrs="{'readonly':[('loai_doituong','=','taixe')],'invisible':[('loai_doituong','!=','taixe')]}"/>
			                    <field name="bai_giaoca_id" string="Bãi giao ca" attrs="{'invisible':[('loai_doituong','!=','taixe')]}"/>
			                    <field name="cmnd" attrs="{'invisible':[('loai_doituong','!=','nhadautu')]}"/>
			                    <field name="giayphep_kinhdoanh" attrs="{'invisible':[('loai_doituong','!=','nhadautu')]}"/>
			                    <field name="so_hoa_don"/>
		                    </group>
	                    </group>
                    	<group col="4" colspan="2">
	                    	<field name="so_tien" required='1' on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)" widget="monetary" options="{'currency_field': 'currency_id'}"/>
	                    	<newline/>
	                    	<field name="residual" string="Còn lại" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    	</group>
                    	<group>
                    		<field name="dien_giai" placeholder="Diễn giải ..." nolabel='1' on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)"/>
                    	</group>
	                    <notebook>
		                    <page string="Payments" groups="base.group_user">
	                            <field name="payment_ids">
	                                <tree string="Payments">
	                                    <field name="date" string="Ngày thanh toán"/>
	                                    <field name="move_id" string="Bút toán"/>
	                                    <field name="journal_id" groups="base.group_user" string="Phương thức thanh toán"/>
	                                    <field name="debit" string="Nợ"/>
	                                    <field name="credit" string="Có"/>
	                                    <field name="amount_currency" groups="base.group_multi_currency"/>
	                                    <field name="currency_id" groups="base.group_multi_currency"/>
	                                </tree>
	                            </field>
	                        </page>
	                        <page string="Chi tiết công nợ" invisible='1'>
			                    <field name="invoice_line" context="{'journal_id': journal_id}">
									<tree editable='bottom'>
										<field name="name" string="Diễn giải"/>
										<field name="account_id" invisible='0'/>
										<field name="price_unit" string="Số tiền"/>
									</tree>			                    
			                    </field>
			                    <field name="period_id" invisible='1'/>
			                    <field name="company_id" invisible='1'/>
			                    <field name="currency_id" invisible='1'/>
			                    <group class="oe_subtotal_footer oe_right">
	                                <field name="amount_total" string="Tổng tiền" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
	                            </group>
	                            <div class="oe_clear"/>
		                    </page>
	                    </notebook>
                    </sheet>
                    <div class="oe_chatter">
		                <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
		                <field name="message_ids" widget="mail_thread"/>
		            </div>
                </form>
            </field>
        </record>
        <record id="action_chi_dien_thoai" model="ir.actions.act_window">
            <field name="name">Chi điện thoại</field>
            <field name="res_model">account.invoice</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_chi_dien_thoai_tree"/>
            <field name="search_view_id" ref="view_chi_dien_thoai_filter"/>
            <field name="domain">[('mlg_type','=','chi_dien_thoai')]</field>
            <field name="context">{'default_mlg_type': 'chi_dien_thoai', 'default_type': 'out_invoice'}</field>
        </record>
		<record id="action_chi_dien_thoai1" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_chi_dien_thoai_tree"/>
            <field name="act_window_id" ref="action_chi_dien_thoai"/>
        </record>
        <record id="action_chi_dien_thoai2" model="ir.actions.act_window.view">
            <field eval="2" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_chi_dien_thoai_form"/>
            <field name="act_window_id" ref="action_chi_dien_thoai"/>
        </record>
        
<!-- Chi bảo hiểm -->
		<record id="view_chi_bao_hiem_filter" model="ir.ui.view">
            <field name="name">chi.bao.hiem.select</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <search string="Search Invoice">
                	<field name="name" string="Mã phiếu đề xuất"/>
                    <field name="date_invoice" string="Ngày giao dịch"/>
                    <field name="partner_id" string="Đối tượng"/>
                    <field name="account_id" string="Tên Phòng ban/Đội xe"/>
                    <field name="chinhanh_id" string="Chi nhánh"/>
                    <field name="journal_id" string="Phương thức thanh toán"/>
                    <field name="so_hop_dong"/>
                    <field name="state"/>
                    <group expand="0" string="Group By">
                    	<filter name="group_by_partner_id" string="Đối tượng" context="{'group_by':'partner_id'}"/>
                    	<filter name="group_by_date_invoice" string="Ngày giao dịch" context="{'group_by':'date_invoice'}"/>
                    	<filter name="group_by_account_id" string="Tên Phòng ban/Đội xe" context="{'group_by':'account_id'}"/>
                    	<filter name="group_by_journal_id" string="Phương thức thanh toán" context="{'group_by':'journal_id'}"/>
                    	<filter name="group_by_chinhanh_id" string="Chi nhánh" context="{'group_by':'chinhanh_id'}"/>
                    	<filter name="group_by_state" string="Trạng thái" context="{'group_by':'state'}"/>
                    </group>
               </search>
            </field>
        </record>
    	<record id="view_chi_bao_hiem_tree" model="ir.ui.view">
            <field name="name">chi.bao.hiem.tree</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <tree string="Chi bảo hiểm">
                	<field name="name" string="Mã phiếu đề xuất"/>
                	<field name="chinhanh_id" string="Chi nhánh"/>
                    <field name="date_invoice" string="Ngày giao dịch"/>
                    <field name="partner_id" string="Đối tượng"/>
                    <field name="account_id" string="Tên Phòng ban/Đội xe"/>
                    <field name="so_hop_dong" string="Số hợp đồng"/>
                    <field name="journal_id" string="Phương thức thanh toán"/>
                    <field name="mlg_type" invisible='1'/>
                    <field name="period_id" invisible='1'/>
                    <field name="currency_id" invisible='1'/>
                    <field name="amount_total" string="Tổng tiền" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="residual" string="Còn lại" groups="account.group_account_user" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="type" invisible='1'/>
                    <field name="state"/>
                </tree>
            </field>
        </record>
        <record id="view_chi_bao_hiem_form" model="ir.ui.view">
            <field name="name">chi.bao.hiem.form</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <form string="Chi bảo hiểm" version='7.0'>
					<header>
	                    <button name="invoice_open" states="draft" string="Approve" class="oe_highlight" groups="base.group_user"/>
	                    <button name="invoice_open" states="proforma2" string="Approve" groups="base.group_user"/>
	                    <button name="invoice_pay_customer" type="object" string="Register Payment"
	                        attrs="{'invisible': [('state','!=','open')]}" class="oe_highlight" groups="base.group_user"/>
	                    <button name="invoice_cancel" states="draft,proforma2,open" string="Cancel Invoice" groups="base.group_no_one"/>
	                    <button name="action_cancel_draft" states="cancel" string="Reset to Draft" type="object" groups="base.group_user"/>
						<field name="state" widget="statusbar" statusbar_visible="draft,open,paid"/>
						<field name="mlg_type" invisible='1'/>
                    	<field name="type" invisible='1'/>
					</header>
                	<sheet>
                		<h1>
                			<label string='Mã phiếu đề xuất'/>
                			<field name="name" nolabel='1' class="oe_inline" readonly='1'/>
                		</h1>
	                    <group col="4" colspan="2">
	                    	<group>
		                    	<field name="chinhanh_id" string="Chi nhánh"/>
		                    	<field name="loai_doituong" string="Loại đối tượng" required='1' on_change="onchange_loaidoituong(loai_doituong)"/>
			                    <field name="partner_id" options="{'no_create': True}" domain="[('customer','=',True)]" string="Đối tượng" context="{'cong_no_thu':1,'loai_doituong':loai_doituong,'form_view_ref':loai_doituong=='taixe' and 'mlg_arap_account.view_tai_xe_form' or (loai_doituong=='nhanvienvanphong' and 'mlg_arap_account.view_nhanvienvanphong_form' or 'mlg_arap_account.view_nha_dau_tu_form')}" on_change="onchange_doituong(partner_id,loai_doituong)"/>
			                    <field name="chinhanh_ndt_id" invisible='1' context="{'cong_no_thu':1,'partner_id':partner_id}" domain="[('parent_id.code','=','1')]" on_change="onchange_chinhanh_ndt(chinhanh_ndt_id,partner_id)" attrs="{'invisible':[('loai_doituong','!=','nhadautu')],'required':[('loai_doituong','=','nhadautu')]}"/>
			                    <field name="journal_id" invisible='1' string="Phương thức thanh toán" widget ="selection" on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)"/>
		                    </group>
		                    <group>
			                    <field name="date_invoice" string="Ngày giao dịch" required='1'/>
			                    <field name="account_id" string="Đội xe" context="{'show_doixe':1,'cong_no_thu_nhadautu':1,'chinhanh_ndt_id':chinhanh_ndt_id,'partner_id':partner_id}" attrs="{'readonly':[('loai_doituong','=','taixe')],'invisible':[('loai_doituong','!=','taixe')]}"/>
			                    <field name="bai_giaoca_id" string="Bãi giao ca" attrs="{'invisible':[('loai_doituong','!=','taixe')]}"/>
			                    <field name="bien_so_xe"/>
			                    <field name="cmnd" attrs="{'invisible':[('loai_doituong','!=','nhadautu')]}"/>
			                    <field name="giayphep_kinhdoanh" attrs="{'invisible':[('loai_doituong','!=','nhadautu')]}"/>
			                    <field name="so_hoa_don"/>
		                    </group>
	                    </group>
                    	<group col="4" colspan="2">
	                    	<field name="so_tien" required='1' on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)" widget="monetary" options="{'currency_field': 'currency_id'}"/>
	                    	<newline/>
	                    	<field name="residual" string="Còn lại" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    	</group>
                    	<group>
                    		<field name="dien_giai" placeholder="Diễn giải ..." nolabel='1' on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)"/>
                    	</group>
	                    <notebook>
		                    <page string="Payments" groups="base.group_user">
	                            <field name="payment_ids">
	                                <tree string="Payments">
	                                    <field name="date" string="Ngày thanh toán"/>
	                                    <field name="move_id" string="Bút toán"/>
	                                    <field name="journal_id" groups="base.group_user" string="Phương thức thanh toán"/>
	                                    <field name="debit" string="Nợ"/>
	                                    <field name="credit" string="Có"/>
	                                    <field name="amount_currency" groups="base.group_multi_currency"/>
	                                    <field name="currency_id" groups="base.group_multi_currency"/>
	                                </tree>
	                            </field>
	                        </page>
	                        <page string="Chi tiết công nợ" invisible='1'>
			                    <field name="invoice_line" context="{'journal_id': journal_id}">
									<tree editable='bottom'>
										<field name="name" string="Diễn giải"/>
										<field name="account_id" invisible='0'/>
										<field name="price_unit" string="Số tiền"/>
									</tree>			                    
			                    </field>
			                    <field name="period_id" invisible='1'/>
			                    <field name="company_id" invisible='1'/>
			                    <field name="currency_id" invisible='1'/>
			                    <group class="oe_subtotal_footer oe_right">
	                                <field name="amount_total" string="Tổng tiền" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
	                            </group>
	                            <div class="oe_clear"/>
		                    </page>
	                    </notebook>
                    </sheet>
                    <div class="oe_chatter">
		                <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
		                <field name="message_ids" widget="mail_thread"/>
		            </div>
                </form>
            </field>
        </record>
        <record id="action_chi_bao_hiem" model="ir.actions.act_window">
            <field name="name">Chi bảo hiểm</field>
            <field name="res_model">account.invoice</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_chi_bao_hiem_tree"/>
            <field name="search_view_id" ref="view_chi_bao_hiem_filter"/>
            <field name="domain">[('mlg_type','=','chi_bao_hiem')]</field>
            <field name="context">{'default_mlg_type': 'chi_bao_hiem', 'default_type': 'out_invoice'}</field>
        </record>
		<record id="action_chi_bao_hiem1" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_chi_bao_hiem_tree"/>
            <field name="act_window_id" ref="action_chi_bao_hiem"/>
        </record>
        <record id="action_chi_bao_hiem2" model="ir.actions.act_window.view">
            <field eval="2" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_chi_bao_hiem_form"/>
            <field name="act_window_id" ref="action_chi_bao_hiem"/>
        </record>

<!-- Phải trả ký quỹ -->
		<record id="view_phai_tra_ky_quy_filter" model="ir.ui.view">
            <field name="name">phai.tra.ky.quy.select</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <search string="Search Invoice">
                	<field name="name" string="Mã phiếu đề xuất"/>
                    <field name="date_invoice" string="Ngày giao dịch"/>
                    <field name="partner_id" string="Đối tượng"/>
                    <field name="account_id" string="Tên Phòng ban/Đội xe"/>
                    <field name="chinhanh_id" string="Chi nhánh"/>
                    <field name="journal_id" string="Phương thức thanh toán"/>
                    <field name="state"/>
                    <group expand="0" string="Group By">
                    	<filter name="group_by_partner_id" string="Đối tượng" context="{'group_by':'partner_id'}"/>
                    	<filter name="group_by_date_invoice" string="Ngày giao dịch" context="{'group_by':'date_invoice'}"/>
                    	<filter name="group_by_account_id" string="Tên Phòng ban/Đội xe" context="{'group_by':'account_id'}"/>
                    	<filter name="group_by_journal_id" string="Phương thức thanh toán" context="{'group_by':'journal_id'}"/>
                    	<filter name="group_by_chinhanh_id" string="Chi nhánh" context="{'group_by':'chinhanh_id'}"/>
                    	<filter name="group_by_state" string="Trạng thái" context="{'group_by':'state'}"/>
                    </group>
               </search>
            </field>
        </record>
    	<record id="view_phai_tra_ky_quy_tree" model="ir.ui.view">
            <field name="name">phai.tra.ky.quy.tree</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <tree string="Phải trả ký quỹ">
                	<field name="name" string="Mã phiếu đề xuất"/>
                	<field name="chinhanh_id" string="Chi nhánh"/>
                    <field name="date_invoice" string="Ngày giao dịch"/>
                    <field name="partner_id" string="Đối tượng"/>
                    <field name="account_id" string="Tên Phòng ban/Đội xe"/>
                    <field name="bai_giaoca_id" string="Bãi giao ca"/>
                    <field name="journal_id" string="Phương thức thanh toán"/>
                    <field name="loai_kyquy_id" string="Loại ký quỹ"/>
                    <field name="mlg_type" invisible='1'/>
                    <field name="period_id" invisible='1'/>
                    <field name="currency_id" invisible='1'/>
                    <field name="amount_total" string="Tổng tiền" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="residual" string="Còn lại" groups="account.group_account_user" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="type" invisible='1'/>
                    <field name="state"/>
                </tree>
            </field>
        </record>
        <record id="view_phai_tra_ky_quy_form" model="ir.ui.view">
            <field name="name">phai.tra.ky.quy.form</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <form string="Phải trả ký quỹ" version='7.0'>
					<header>
	                    <button name="invoice_open" states="draft" string="Approve" class="oe_highlight" groups="base.group_user"/>
	                    <button name="invoice_open" states="proforma2" string="Approve" groups="base.group_user"/>
	                    <button name="invoice_pay_customer" type="object" string="Register Payment"
	                        attrs="{'invisible': [('state','!=','open')]}" class="oe_highlight" groups="base.group_user"/>
	                    <button name="invoice_cancel" states="draft,proforma2,open" string="Cancel Invoice" groups="base.group_no_one"/>
	                    <button name="action_cancel_draft" states="cancel" string="Reset to Draft" type="object" groups="base.group_user"/>
						<field name="state" widget="statusbar" statusbar_visible="draft,open,paid"/>
						<field name="mlg_type" invisible='1'/>
                    	<field name="type" invisible='1'/>
                    	<field name="loai_doituong" invisible='1'/>
					</header>
                	<sheet>
                		<h1>
                			<label string='Mã phiếu đề xuất'/>
                			<field name="name" nolabel='1' class="oe_inline" readonly='1'/>
                		</h1>
	                    <group col="4" colspan="2">
	                    	<group>
		                    	<field name="chinhanh_id" string="Chi nhánh"/>
		                    	<field name="loai_doituong" string="Loại đối tượng" required='1' on_change="onchange_loaidoituong(loai_doituong)"/>
			                    <field name="partner_id" options="{'no_create': True}" domain="[('customer','=',True)]" string="Đối tượng" context="{'cong_no_thu':1,'loai_doituong':loai_doituong,'form_view_ref':loai_doituong=='taixe' and 'mlg_arap_account.view_tai_xe_form' or (loai_doituong=='nhanvienvanphong' and 'mlg_arap_account.view_nhanvienvanphong_form' or 'mlg_arap_account.view_nha_dau_tu_form')}" on_change="onchange_doituong(partner_id,loai_doituong)"/>
			                    <field name="chinhanh_ndt_id" invisible='1' context="{'cong_no_thu':1,'partner_id':partner_id}" domain="[('parent_id.code','=','1')]" on_change="onchange_chinhanh_ndt(chinhanh_ndt_id,partner_id)" attrs="{'invisible':[('loai_doituong','!=','nhadautu')],'required':[('loai_doituong','=','nhadautu')]}"/>
			                    <field name="journal_id" invisible='1' string="Phương thức thanh toán" widget ="selection" on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)"/>
		                    </group>
		                    <group>
			                    <field name="date_invoice" string="Ngày giao dịch" required='1'/>
			                    <field name="account_id" string="Đội xe" context="{'show_doixe':1,'cong_no_thu_nhadautu':1,'chinhanh_ndt_id':chinhanh_ndt_id,'partner_id':partner_id}" attrs="{'readonly':[('loai_doituong','=','taixe')],'invisible':[('loai_doituong','!=','taixe')]}"/>
			                    <field name="bai_giaoca_id" string="Bãi giao ca" attrs="{'invisible':[('loai_doituong','!=','taixe')]}"/>
			                    <field name="bien_so_xe"/>
			                    <field name="cmnd" attrs="{'invisible':[('loai_doituong','!=','nhadautu')]}"/>
			                    <field name="giayphep_kinhdoanh" attrs="{'invisible':[('loai_doituong','!=','nhadautu')]}"/>
			                    <field name="loai_kyquy_id" options="{'no_create': True}"/>
		                    </group>
	                    </group>
                    	<group col="4" colspan="2">
	                    	<field name="so_tien" required='1' on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)" widget="monetary" options="{'currency_field': 'currency_id'}"/>
	                    	<newline/>
	                    	<field name="residual" string="Còn lại" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    	</group>
                    	<group>
                    		<field name="dien_giai" placeholder="Diễn giải ..." nolabel='1' on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)"/>
                    	</group>
	                    <notebook>
		                    <page string="Payments" groups="base.group_user">
	                            <field name="payment_ids">
	                                <tree string="Payments">
	                                    <field name="date" string="Ngày thanh toán"/>
	                                    <field name="move_id" string="Bút toán"/>
	                                    <field name="journal_id" groups="base.group_user" string="Phương thức thanh toán"/>
	                                    <field name="debit" string="Nợ"/>
	                                    <field name="credit" string="Có"/>
	                                    <field name="amount_currency" groups="base.group_multi_currency"/>
	                                    <field name="currency_id" groups="base.group_multi_currency"/>
	                                </tree>
	                            </field>
	                        </page>
	                        <page string="Chi tiết công nợ" invisible='1'>
			                    <field name="invoice_line" context="{'journal_id': journal_id}">
									<tree editable='bottom'>
										<field name="name" string="Diễn giải"/>
										<field name="account_id" invisible='0'/>
										<field name="price_unit" string="Số tiền"/>
									</tree>			                    
			                    </field>
			                    <field name="period_id" invisible='1'/>
			                    <field name="company_id" invisible='1'/>
			                    <field name="currency_id" invisible='1'/>
			                    <group class="oe_subtotal_footer oe_right">
	                                <field name="amount_total" string="Tổng tiền" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
	                            </group>
	                            <div class="oe_clear"/>
		                    </page>
	                    </notebook>
                    </sheet>
                    <div class="oe_chatter">
		                <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
		                <field name="message_ids" widget="mail_thread"/>
		            </div>
                </form>
            </field>
        </record>
        <record id="action_phai_tra_ky_quy" model="ir.actions.act_window">
            <field name="name">Phải trả ký quỹ</field>
            <field name="res_model">account.invoice</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_phai_tra_ky_quy_tree"/>
            <field name="search_view_id" ref="view_phai_tra_ky_quy_filter"/>
            <field name="domain">[('mlg_type','=','phai_tra_ky_quy')]</field>
            <field name="context">{'default_mlg_type': 'phai_tra_ky_quy', 'default_type': 'out_invoice'}</field>
        </record>
		<record id="action_phai_tra_ky_quy1" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_phai_tra_ky_quy_tree"/>
            <field name="act_window_id" ref="action_phai_tra_ky_quy"/>
        </record>
        <record id="action_phai_tra_ky_quy2" model="ir.actions.act_window.view">
            <field eval="2" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_phai_tra_ky_quy_form"/>
            <field name="act_window_id" ref="action_phai_tra_ky_quy"/>
        </record>
        
<!-- Tạm ứng -->
		<record id="view_tam_ung_filter" model="ir.ui.view">
            <field name="name">tam.ung.select</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <search string="Tạm ứng">
                	<field name="name" string="Mã phiếu đề xuất"/>
                	<field name="chinhanh_id" string="Chi nhánh"/>
                    <field name="date_invoice" string="Ngày giao dịch"/>
                    <field name="partner_id" string="Đối tượng"/>
                    <field name="account_id" string="Phòng ban/Đội xe"/>
                    <field name="journal_id" string="Phương thức thanh toán"/>
                    <field name="state"/>
                    <group expand="0" string="Group By">
                    	<filter name="group_by_partner_id" string="Đối tượng" context="{'group_by':'partner_id'}"/>
                    	<filter name="group_by_date_invoice" string="Ngày giao dịch" context="{'group_by':'date_invoice'}"/>
                    	<filter name="group_by_account_id" string="Phòng ban/Đội xe" context="{'group_by':'account_id'}"/>
                    	<filter name="group_by_journal_id" string="Phương thức thanh toán" context="{'group_by':'journal_id'}"/>
                    	<filter name="group_by_chinhanh_id" string="Chi nhánh" context="{'group_by':'chinhanh_id'}"/>
                    	<filter name="group_by_state" string="Trạng thái" context="{'group_by':'state'}"/>
                    </group>
               </search>
            </field>
        </record>
    	<record id="view_tam_ung_tree" model="ir.ui.view">
            <field name="name">tam.ung.tree</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <tree string="Tạm ứng">
                	<field name="name" string="Mã phiếu đề xuất"/>
                	<field name="chinhanh_id" string="Chi nhánh"/>
                    <field name="date_invoice" string="Ngày giao dịch"/>
                    <field name="partner_id" string="Đối tượng"/>
                    <field name="account_id" string="Phòng ban/Đội xe"/>
                    <field name="journal_id" string="Phương thức thanh toán"/>
                    <field name="so_hop_dong" string="Mã hợp đồng"/>
                    <field name="period_id" invisible='1'/>
                    <field name="currency_id" invisible='1'/>
                    <field name="amount_total" string="Tổng tiền" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="residual" string="Còn lại" groups="account.group_account_user" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="state"/>
                    <field name="mlg_type" invisible='1'/>
                    <field name="type" invisible='1'/>
                </tree>
            </field>
        </record>
        <record id="view_tam_ung_form" model="ir.ui.view">
            <field name="name">tam.ung.form</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <form string="Tạm ứng" version='7.0'>
					<header>
	                    <button name="invoice_open" states="draft" string="Approve" class="oe_highlight" groups="base.group_user"/>
	                    <button name="invoice_open" states="proforma2" string="Approve" groups="base.group_user"/>
	                    <button name="invoice_pay_customer" type="object" string="Register Payment"
	                        attrs="{'invisible': [('state','!=','open')]}" class="oe_highlight" groups="base.group_user"/>
	                    <button name="invoice_cancel" states="draft,proforma2,open" string="Cancel Invoice" groups="base.group_no_one"/>
	                    <button name="action_cancel_draft" states="cancel" string="Reset to Draft" type="object" groups="base.group_user"/>
						<field name="state" widget="statusbar" statusbar_visible="draft,open,paid"/>
						<field name="mlg_type" invisible='1'/>
                    	<field name="type" invisible='1'/>
					</header>
                	<sheet>
                		<h1>
                			<label string='Mã phiếu đề xuất'/>
                			<field name="name" nolabel='1' class="oe_inline" readonly='1'/>
                		</h1>
                		<group col="4" colspan="2">
	                    	<group>
		                    	<field name="chinhanh_id" string="Chi nhánh"/>
		                    	<field name="loai_doituong" string="Loại đối tượng" required='1' on_change="onchange_loaidoituong(loai_doituong)"/>
			                    <field name="partner_id" options="{'no_create': True}" domain="[('customer','=',True)]" string="Đối tượng" context="{'cong_no_thu':1,'loai_doituong':loai_doituong,'form_view_ref':loai_doituong=='taixe' and 'mlg_arap_account.view_tai_xe_form' or (loai_doituong=='nhanvienvanphong' and 'mlg_arap_account.view_nhanvienvanphong_form' or 'mlg_arap_account.view_nha_dau_tu_form')}" on_change="onchange_doituong(partner_id,loai_doituong)"/>
			                    <field name="chinhanh_ndt_id" invisible='1' context="{'cong_no_thu':1,'partner_id':partner_id}" domain="[('parent_id.code','=','1')]" on_change="onchange_chinhanh_ndt(chinhanh_ndt_id,partner_id)" attrs="{'invisible':[('loai_doituong','!=','nhadautu')],'required':[('loai_doituong','=','nhadautu')]}"/>
			                    <field name="journal_id" invisible='1' string="Phương thức thanh toán" widget ="selection" on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)"/>
		                    </group>
		                    <group>
			                    <field name="date_invoice" string="Ngày giao dịch" required='1'/>
			                    <field name="account_id" string="Đội xe" context="{'show_doixe':1,'cong_no_thu_nhadautu':1,'chinhanh_ndt_id':chinhanh_ndt_id,'partner_id':partner_id}" attrs="{'readonly':[('loai_doituong','=','taixe')],'invisible':[('loai_doituong','!=','taixe')]}"/>
			                    <field name="bai_giaoca_id" string="Bãi giao ca" attrs="{'invisible':[('loai_doituong','!=','taixe')]}"/>
			                    <field name="bien_so_xe"/>
			                    <field name="cmnd" attrs="{'invisible':[('loai_doituong','!=','nhadautu')]}"/>
			                    <field name="giayphep_kinhdoanh" attrs="{'invisible':[('loai_doituong','!=','nhadautu')]}"/>
			                    <field name="so_hop_dong"/>
			                    <field name="loai_tamung_id" options="{'no_create': True}"/>
		                    </group>
	                    </group>
                    	<group col="4" colspan="2">
	                    	<field name="so_tien" required='1' on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)" widget="monetary" options="{'currency_field': 'currency_id'}"/>
	                    	<newline/>
	                    	<field name="residual" string="Còn lại" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    	</group>
                    	<group>
                    		<field name="dien_giai" placeholder="Diễn giải ..." nolabel='1' on_change="onchange_dien_giai_st(dien_giai,so_tien,journal_id)"/>
                    	</group>
	                    <notebook>
		                    <page string="Payments" groups="base.group_user">
	                            <field name="payment_ids">
	                                <tree string="Payments">
	                                    <field name="date" string="Ngày thanh toán"/>
	                                    <field name="move_id" string="Bút toán"/>
	                                    <field name="journal_id" groups="base.group_user" string="Phương thức thanh toán"/>
	                                    <field name="debit" string="Nợ"/>
	                                    <field name="credit" string="Có"/>
	                                    <field name="amount_currency" groups="base.group_multi_currency"/>
	                                    <field name="currency_id" groups="base.group_multi_currency"/>
	                                </tree>
	                            </field>
	                        </page>
	                        <page string="Chi tiết công nợ" invisible='1'>
			                    <field name="invoice_line" context="{'journal_id': journal_id}">
									<tree editable='bottom'>
										<field name="name" string="Diễn giải"/>
										<field name="account_id" invisible='0'/>
										<field name="price_unit" string="Số tiền"/>
									</tree>			                    
			                    </field>
			                    <field name="period_id" invisible='1'/>
			                    <field name="company_id" invisible='1'/>
			                    <field name="currency_id" invisible='1'/>
			                    <group class="oe_subtotal_footer oe_right">
	                                <field name="amount_total" string="Tổng tiền" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
	                            </group>
	                            <div class="oe_clear"/>
		                    </page>
	                    </notebook>
                    </sheet>
                    <div class="oe_chatter">
		                <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
		                <field name="message_ids" widget="mail_thread"/>
		            </div>
                </form>
            </field>
        </record>
        <record id="action_tam_ung" model="ir.actions.act_window">
            <field name="name">Tạm ứng</field>
            <field name="res_model">account.invoice</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_tam_ung_tree"/>
            <field name="search_view_id" ref="view_tam_ung_filter"/>
            <field name="domain">[('mlg_type','=','tam_ung')]</field>
            <field name="context">{'default_mlg_type': 'tam_ung', 'default_type': 'out_invoice'}</field>
        </record>
		<record id="action_tam_ung1" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_tam_ung_tree"/>
            <field name="act_window_id" ref="action_tam_ung"/>
        </record>
        <record id="action_tam_ung2" model="ir.actions.act_window.view">
            <field eval="2" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_tam_ung_form"/>
            <field name="act_window_id" ref="action_tam_ung"/>
        </record>
        
<!-- Thu ký quỹ -->
		<record id="view_thu_ky_quy_filter" model="ir.ui.view">
            <field name="name">thu.ky.quy.select</field>
            <field name="model">thu.ky.quy</field>
            <field name="arch" type="xml">
                <search string="Thu ký quỹ">
                	<field name="name"/>
                    <field name="chinhanh_id"/>
                    <field name="partner_id"/>
                    <field name="user_id"/>
                    <field name="so_tien"/>
                    <field name="ngay_thu"/>
                    <field name="dien_giai"/>
                    <field name="state"/>
                    <group expand="0" string="Group By">
                    	<filter name="group_by_partner_id" string="Đối tượng" context="{'group_by':'partner_id'}"/>
                    	<filter name="group_by_ngay_thu" string="Ngày thu" context="{'group_by':'ngay_thu'}"/>
                    	<filter name="group_by_user_id" string="Nhân viên thu" context="{'group_by':'user_id'}"/>
                    	<filter name="group_by_chinhanh_id" string="Chi nhánh" context="{'group_by':'chinhanh_id'}"/>
                    	<filter name="group_by_state" string="Trạng thái" context="{'group_by':'state'}"/>
                    </group>
               </search>
            </field>
        </record>
    	<record id="view_thu_ky_quy_tree" model="ir.ui.view">
            <field name="name">thu.ky.quy.tree</field>
            <field name="model">thu.ky.quy</field>
            <field name="arch" type="xml">
                <tree string="Thu ký quỹ">
                	<field name="name"/>
                    <field name="chinhanh_id"/>
                    <field name="partner_id"/>
                    <field name="user_id"/>
                    <field name="ngay_thu"/>
                    <field name="so_tien"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>
        <record id="view_thu_ky_quy_form" model="ir.ui.view">
            <field name="name">thu.ky.quy.form</field>
            <field name="model">thu.ky.quy</field>
            <field name="arch" type="xml">
                <form string="Thu ký quỹ" version='7.0'>
					<header>
	                    <button name="bt_thu" states="draft" type='object' string="Thu" class="oe_highlight"/>
	                    <button name="bt_huybo" states="draft,paid" type='object' string="Hủy bỏ" class="oe_highlight"/>
						<field name="state" widget="statusbar" statusbar_visible="draft,open,paid"/>
						<field name="currency_id" invisible='1'/>
						<field name="loai_doituong" invisible='1'/>
					</header>
                	<sheet>
                		<h1>
                			<label string='Mã phiếu đề xuất'/>
                			<field name="name" nolabel='1' class="oe_inline" readonly='1'/>
                		</h1>
	                    <group col="4" colspan="2">
	                    	<group>
		                    	<field name="chinhanh_id"/>
			                    <field name="partner_id" options="{'no_create': True}" on_change="onchange_doituong(partner_id)" domain="['|','|',('taixe','=',True),('nhadautu','=',True),('nhanvienvanphong','=',True)]" string="Đối tượng" context="{'doituong_thukyquy':1,'chinhanh_id':chinhanh_id,'form_view_ref':loai_doituong=='taixe' and 'mlg_arap_account.view_tai_xe_form' or (loai_doituong=='nhanvienvanphong' and 'mlg_arap_account.view_nhanvienvanphong_form' or 'mlg_arap_account.view_nha_dau_tu_form')}"/>
		                    </group>
		                    <group>
			                    <field name="ngay_thu"/>
			                    <field name="user_id"/>
		                    </group>
	                    </group>
                    	<group col="4" colspan="2">
	                    	<field name="so_tien" required='1' widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    	</group>
                    	<group>
                    		<field name="dien_giai" placeholder="Diễn giải ..." nolabel='1'/>
                    	</group>
                    </sheet>
                    <div class="oe_chatter">
		                <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
		                <field name="message_ids" widget="mail_thread"/>
		            </div>
                </form>
            </field>
        </record>
        <record id="action_thu_ky_quy" model="ir.actions.act_window">
            <field name="name">Thu ký quỹ</field>
            <field name="res_model">thu.ky.quy</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_thu_ky_quy_tree"/>
            <field name="search_view_id" ref="view_thu_ky_quy_filter"/>
        </record>
        
	</data>
</openerp>